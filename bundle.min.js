!function t(e,r,n){function i(s,a){if(!r[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var c=r[s]={exports:{}};e[s][0].call(c.exports,function(t){var r=e[s][1][t];return i(r?r:t)},c,c.exports,t,e,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,r){},{}],2:[function(t,e,r){arguments[4][1][0].apply(r,arguments)},{dup:1}],3:[function(t,e,r){function n(t,e){var r=this;if(!(r instanceof n))return new n(t,e);var i,o=typeof t;if("number"===o)i=+t;else if("string"===o)i=n.byteLength(t,e);else{if("object"!==o||null===t)throw new TypeError("must start with number, buffer, array or string");"Buffer"===t.type&&B(t.data)&&(t=t.data),i=+t.length}if(i>P)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+P.toString(16)+" bytes");0>i?i=0:i>>>=0,n.TYPED_ARRAY_SUPPORT?r=n._augment(new Uint8Array(i)):(r.length=i,r._isBuffer=!0);var s;if(n.TYPED_ARRAY_SUPPORT&&"number"==typeof t.byteLength)r._set(t);else if(I(t))if(n.isBuffer(t))for(s=0;i>s;s++)r[s]=t.readUInt8(s);else for(s=0;i>s;s++)r[s]=(t[s]%256+256)%256;else if("string"===o)r.write(t,0,e);else if("number"===o&&!n.TYPED_ARRAY_SUPPORT)for(s=0;i>s;s++)r[s]=0;return i>0&&i<=n.poolSize&&(r.parent=j),r}function i(t,e){if(!(this instanceof i))return new i(t,e);var r=new n(t,e);return delete r.parent,r}function o(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var o=e.length;if(o%2!==0)throw new Error("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;n>s;s++){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");t[r+s]=a}return s}function s(t,e,r,n){var i=J(_(e,t.length-r),t,r,n);return i}function a(t,e,r,n){var i=J(L(e),t,r,n);return i}function u(t,e,r,n){return a(t,e,r,n)}function h(t,e,r,n){var i=J(k(e),t,r,n);return i}function c(t,e,r,n){var i=J(A(e,t.length-r),t,r,n);return i}function f(t,e,r){return T.fromByteArray(0===e&&r===t.length?t:t.slice(e,r))}function p(t,e,r){var n="",i="";r=Math.min(t.length,r);for(var o=e;r>o;o++)t[o]<=127?(n+=R(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return n+R(i)}function l(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(127&t[i]);return n}function d(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(t[i]);return n}function m(t,e,r){var n=t.length;(!e||0>e)&&(e=0),(!r||0>r||r>n)&&(r=n);for(var i="",o=e;r>o;o++)i+=C(t[o]);return i}function g(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function y(t,e,r){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function x(t,e,r,i,o,s){if(!n.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>o||s>e)throw new RangeError("value is out of bounds");if(r+i>t.length)throw new RangeError("index out of range")}function v(t,e,r,n){0>e&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);o>i;i++)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function w(t,e,r,n){0>e&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);o>i;i++)t[r+i]=e>>>8*(n?i:3-i)&255}function b(t,e,r,n,i,o){if(e>i||o>e)throw new RangeError("value is out of bounds");if(r+n>t.length)throw new RangeError("index out of range");if(0>r)throw new RangeError("index out of range")}function S(t,e,r,n,i){return i||b(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),M.write(t,e,r,n,23,4),r+4}function E(t,e,r,n,i){return i||b(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),M.write(t,e,r,n,52,8),r+8}function O(t){if(t=N(t).replace(U,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function N(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function I(t){return B(t)||n.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function C(t){return 16>t?"0"+t.toString(16):t.toString(16)}function _(t,e){e=e||1/0;for(var r,n=t.length,i=null,o=[],s=0;n>s;s++){if(r=t.charCodeAt(s),r>55295&&57344>r){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(56320>r){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&((e-=3)>-1&&o.push(239,191,189),i=null);if(128>r){if((e-=1)<0)break;o.push(r)}else if(2048>r){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(65536>r){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(2097152>r))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function L(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e}function A(t,e){for(var r,n,i,o=[],s=0;s<t.length&&!((e-=2)<0);s++)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function k(t){return T.toByteArray(O(t))}function J(t,e,r,n){for(var i=0;n>i&&!(i+r>=e.length||i>=t.length);i++)e[i+r]=t[i];return i}function R(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}var T=t("base64-js"),M=t("ieee754"),B=t("is-array");r.Buffer=n,r.SlowBuffer=i,r.INSPECT_MAX_BYTES=50,n.poolSize=8192;var P=1073741823,j={};n.TYPED_ARRAY_SUPPORT=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(r){return!1}}(),n.isBuffer=function(t){return!(null==t||!t._isBuffer)},n.compare=function(t,e){if(!n.isBuffer(t)||!n.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,i=e.length,o=0,s=Math.min(r,i);s>o&&t[o]===e[o];o++);return o!==s&&(r=t[o],i=e[o]),i>r?-1:r>i?1:0},n.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(t,e){if(!B(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new n(0);if(1===t.length)return t[0];var r;if(void 0===e)for(e=0,r=0;r<t.length;r++)e+=t[r].length;var i=new n(e),o=0;for(r=0;r<t.length;r++){var s=t[r];s.copy(i,o),o+=s.length}return i},n.byteLength=function(t,e){var r;switch(t+="",e||"utf8"){case"ascii":case"binary":case"raw":r=t.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=2*t.length;break;case"hex":r=t.length>>>1;break;case"utf8":case"utf-8":r=_(t).length;break;case"base64":r=k(t).length;break;default:r=t.length}return r},n.prototype.length=void 0,n.prototype.parent=void 0,n.prototype.toString=function(t,e,r){var n=!1;if(e>>>=0,r=void 0===r||r===1/0?this.length:r>>>0,t||(t="utf8"),0>e&&(e=0),r>this.length&&(r=this.length),e>=r)return"";for(;;)switch(t){case"hex":return m(this,e,r);case"utf8":case"utf-8":return p(this,e,r);case"ascii":return l(this,e,r);case"binary":return d(this,e,r);case"base64":return f(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return g(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}},n.prototype.equals=function(t){if(!n.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:0===n.compare(this,t)},n.prototype.inspect=function(){var t="",e=r.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},n.prototype.compare=function(t){if(!n.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:n.compare(this,t)},n.prototype.indexOf=function(t,e){function r(t,e,r){for(var n=-1,i=0;r+i<t.length;i++)if(t[r+i]===e[-1===n?0:i-n]){if(-1===n&&(n=i),i-n+1===e.length)return r+n}else n=-1;return-1}if(e>2147483647?e=2147483647:-2147483648>e&&(e=-2147483648),e>>=0,0===this.length)return-1;if(e>=this.length)return-1;if(0>e&&(e=Math.max(this.length+e,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,e);if(n.isBuffer(t))return r(this,t,e);if("number"==typeof t)return n.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,e):r(this,[t],e);throw new TypeError("val must be string, number or Buffer")},n.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},n.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},n.prototype.write=function(t,e,r,n){if(isFinite(e))isFinite(r)||(n=r,r=void 0);else{var i=n;n=e,e=r,r=i}if(e=Number(e)||0,0>r||0>e||e>this.length)throw new RangeError("attempt to write outside buffer bounds");var f=this.length-e;r?(r=Number(r),r>f&&(r=f)):r=f,n=String(n||"utf8").toLowerCase();var p;switch(n){case"hex":p=o(this,t,e,r);break;case"utf8":case"utf-8":p=s(this,t,e,r);break;case"ascii":p=a(this,t,e,r);break;case"binary":p=u(this,t,e,r);break;case"base64":p=h(this,t,e,r);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":p=c(this,t,e,r);break;default:throw new TypeError("Unknown encoding: "+n)}return p},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},n.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,0>t?(t+=r,0>t&&(t=0)):t>r&&(t=r),0>e?(e+=r,0>e&&(e=0)):e>r&&(e=r),t>e&&(e=t);var i;if(n.TYPED_ARRAY_SUPPORT)i=n._augment(this.subarray(t,e));else{var o=e-t;i=new n(o,void 0);for(var s=0;o>s;s++)i[s]=this[s+t]}return i.length&&(i.parent=this.parent||this),i},n.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||y(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},n.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||y(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},n.prototype.readUInt8=function(t,e){return e||y(t,1,this.length),this[t]},n.prototype.readUInt16LE=function(t,e){return e||y(t,2,this.length),this[t]|this[t+1]<<8},n.prototype.readUInt16BE=function(t,e){return e||y(t,2,this.length),this[t]<<8|this[t+1]},n.prototype.readUInt32LE=function(t,e){return e||y(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},n.prototype.readUInt32BE=function(t,e){return e||y(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},n.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||y(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},n.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||y(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},n.prototype.readInt8=function(t,e){return e||y(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},n.prototype.readInt16LE=function(t,e){e||y(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},n.prototype.readInt16BE=function(t,e){e||y(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},n.prototype.readInt32LE=function(t,e){return e||y(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},n.prototype.readInt32BE=function(t,e){return e||y(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},n.prototype.readFloatLE=function(t,e){return e||y(t,4,this.length),M.read(this,t,!0,23,4)},n.prototype.readFloatBE=function(t,e){return e||y(t,4,this.length),M.read(this,t,!1,23,4)},n.prototype.readDoubleLE=function(t,e){return e||y(t,8,this.length),M.read(this,t,!0,52,8)},n.prototype.readDoubleBE=function(t,e){return e||y(t,8,this.length),M.read(this,t,!1,52,8)},n.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||x(this,t,e,r,Math.pow(2,8*r),0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i>>>0&255;return e+r},n.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||x(this,t,e,r,Math.pow(2,8*r),0);var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o>>>0&255;return e+r},n.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||x(this,t,e,1,255,0),n.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t,e+1},n.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||x(this,t,e,2,65535,0),n.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):v(this,t,e,!0),e+2},n.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||x(this,t,e,2,65535,0),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):v(this,t,e,!1),e+2},n.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||x(this,t,e,4,4294967295,0),n.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t):w(this,t,e,!0),e+4},n.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||x(this,t,e,4,4294967295,0),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):w(this,t,e,!1),e+4},n.prototype.writeIntLE=function(t,e,r,n){t=+t,e>>>=0,n||x(this,t,e,r,Math.pow(2,8*r-1)-1,-Math.pow(2,8*r-1));var i=0,o=1,s=0>t?1:0;for(this[e]=255&t;++i<r&&(o*=256);)this[e+i]=(t/o>>0)-s&255;return e+r},n.prototype.writeIntBE=function(t,e,r,n){t=+t,e>>>=0,n||x(this,t,e,r,Math.pow(2,8*r-1)-1,-Math.pow(2,8*r-1));var i=r-1,o=1,s=0>t?1:0;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=(t/o>>0)-s&255;return e+r},n.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||x(this,t,e,1,127,-128),n.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[e]=t,e+1},n.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||x(this,t,e,2,32767,-32768),n.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):v(this,t,e,!0),e+2},n.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||x(this,t,e,2,32767,-32768),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):v(this,t,e,!1),e+2},n.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||x(this,t,e,4,2147483647,-2147483648),n.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):w(this,t,e,!0),e+4},n.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||x(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):w(this,t,e,!1),e+4},n.prototype.writeFloatLE=function(t,e,r){return S(this,t,e,!0,r)},n.prototype.writeFloatBE=function(t,e,r){return S(this,t,e,!1,r)},n.prototype.writeDoubleLE=function(t,e,r){return E(this,t,e,!0,r)},n.prototype.writeDoubleBE=function(t,e,r){return E(this,t,e,!1,r)},n.prototype.copy=function(t,e,r,i){if(r||(r=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&r>i&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(0>e)throw new RangeError("targetStart out of bounds");if(0>r||r>=this.length)throw new RangeError("sourceStart out of bounds");if(0>i)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var o=i-r;if(1e3>o||!n.TYPED_ARRAY_SUPPORT)for(var s=0;o>s;s++)t[s+e]=this[s+r];else t._set(this.subarray(r,r+o),e);return o},n.prototype.fill=function(t,e,r){if(t||(t=0),e||(e=0),r||(r=this.length),e>r)throw new RangeError("end < start");if(r!==e&&0!==this.length){if(0>e||e>=this.length)throw new RangeError("start out of bounds");if(0>r||r>this.length)throw new RangeError("end out of bounds");var n;if("number"==typeof t)for(n=e;r>n;n++)this[n]=t;else{var i=_(t.toString()),o=i.length;for(n=e;r>n;n++)this[n]=i[n%o]}return this}},n.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(n.TYPED_ARRAY_SUPPORT)return new n(this).buffer;for(var t=new Uint8Array(this.length),e=0,r=t.length;r>e;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var D=n.prototype;n._augment=function(t){return t.constructor=n,t._isBuffer=!0,t._set=t.set,t.get=D.get,t.set=D.set,t.write=D.write,t.toString=D.toString,t.toLocaleString=D.toString,t.toJSON=D.toJSON,t.equals=D.equals,t.compare=D.compare,t.indexOf=D.indexOf,t.copy=D.copy,t.slice=D.slice,t.readUIntLE=D.readUIntLE,t.readUIntBE=D.readUIntBE,t.readUInt8=D.readUInt8,t.readUInt16LE=D.readUInt16LE,t.readUInt16BE=D.readUInt16BE,t.readUInt32LE=D.readUInt32LE,t.readUInt32BE=D.readUInt32BE,t.readIntLE=D.readIntLE,t.readIntBE=D.readIntBE,t.readInt8=D.readInt8,t.readInt16LE=D.readInt16LE,t.readInt16BE=D.readInt16BE,t.readInt32LE=D.readInt32LE,t.readInt32BE=D.readInt32BE,t.readFloatLE=D.readFloatLE,t.readFloatBE=D.readFloatBE,t.readDoubleLE=D.readDoubleLE,t.readDoubleBE=D.readDoubleBE,t.writeUInt8=D.writeUInt8,t.writeUIntLE=D.writeUIntLE,t.writeUIntBE=D.writeUIntBE,t.writeUInt16LE=D.writeUInt16LE,t.writeUInt16BE=D.writeUInt16BE,t.writeUInt32LE=D.writeUInt32LE,t.writeUInt32BE=D.writeUInt32BE,t.writeIntLE=D.writeIntLE,t.writeIntBE=D.writeIntBE,t.writeInt8=D.writeInt8,t.writeInt16LE=D.writeInt16LE,t.writeInt16BE=D.writeInt16BE,t.writeInt32LE=D.writeInt32LE,t.writeInt32BE=D.writeInt32BE,t.writeFloatLE=D.writeFloatLE,t.writeFloatBE=D.writeFloatBE,t.writeDoubleLE=D.writeDoubleLE,t.writeDoubleBE=D.writeDoubleBE,t.fill=D.fill,t.inspect=D.inspect,t.toArrayBuffer=D.toArrayBuffer,t};var U=/[^+\/0-9A-z\-]/g},{"base64-js":4,ieee754:5,"is-array":6}],4:[function(t,e,r){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===s||e===f?62:e===a||e===p?63:u>e?-1:u+10>e?e-u+26+26:c+26>e?e-c:h+26>e?e-h+26:void 0}function r(t){function r(t){h[f++]=t}var n,i,s,a,u,h;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=t.length;u="="===t.charAt(c-2)?2:"="===t.charAt(c-1)?1:0,h=new o(3*t.length/4-u),s=u>0?t.length-4:t.length;var f=0;for(n=0,i=0;s>n;n+=4,i+=3)a=e(t.charAt(n))<<18|e(t.charAt(n+1))<<12|e(t.charAt(n+2))<<6|e(t.charAt(n+3)),r((16711680&a)>>16),r((65280&a)>>8),r(255&a);return 2===u?(a=e(t.charAt(n))<<2|e(t.charAt(n+1))>>4,r(255&a)):1===u&&(a=e(t.charAt(n))<<10|e(t.charAt(n+1))<<4|e(t.charAt(n+2))>>2,r(a>>8&255),r(255&a)),h}function i(t){function e(t){return n.charAt(t)}function r(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var i,o,s,a=t.length%3,u="";for(i=0,s=t.length-a;s>i;i+=3)o=(t[i]<<16)+(t[i+1]<<8)+t[i+2],u+=r(o);switch(a){case 1:o=t[t.length-1],u+=e(o>>2),u+=e(o<<4&63),u+="==";break;case 2:o=(t[t.length-2]<<8)+t[t.length-1],u+=e(o>>10),u+=e(o>>4&63),u+=e(o<<2&63),u+="="}return u}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),a="/".charCodeAt(0),u="0".charCodeAt(0),h="a".charCodeAt(0),c="A".charCodeAt(0),f="-".charCodeAt(0),p="_".charCodeAt(0);t.toByteArray=r,t.fromByteArray=i}("undefined"==typeof r?this.base64js={}:r)},{}],5:[function(t,e,r){r.read=function(t,e,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,h=u>>1,c=-7,f=r?i-1:0,p=r?-1:1,l=t[e+f];for(f+=p,o=l&(1<<-c)-1,l>>=-c,c+=a;c>0;o=256*o+t[e+f],f+=p,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=n;c>0;s=256*s+t[e+f],f+=p,c-=8);if(0===o)o=1-h;else{if(o===u)return s?0/0:(l?-1:1)*(1/0);s+=Math.pow(2,n),o-=h}return(l?-1:1)*s*Math.pow(2,o-n)},r.write=function(t,e,r,n,i,o){var s,a,u,h=8*o-i-1,c=(1<<h)-1,f=c>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,l=n?0:o-1,d=n?1:-1,m=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),e+=s+f>=1?p/u:p*Math.pow(2,1-f),e*u>=2&&(s++,u/=2),s+f>=c?(a=0,s=c):s+f>=1?(a=(e*u-1)*Math.pow(2,i),s+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;t[r+l]=255&a,l+=d,a/=256,i-=8);for(s=s<<i|a,h+=i;h>0;t[r+l]=255&s,l+=d,s/=256,h-=8);t[r+l-d]|=128*m}},{}],6:[function(t,e,r){var n=Array.isArray,i=Object.prototype.toString;e.exports=n||function(t){return!!t&&"[object Array]"==i.call(t)}},{}],7:[function(t,e,r){e.exports=function(){var e=t("events"),r={};return r.createDomain=r.create=function(){function t(t){r.emit("error",t)}var r=new e.EventEmitter;return r.add=function(e){e.on("error",t)},r.remove=function(e){e.removeListener("error",t)},r.bind=function(e){return function(){var r=Array.prototype.slice.call(arguments);try{e.apply(null,r)}catch(n){t(n)}}},r.intercept=function(e){return function(r){if(r)t(r);else{var n=Array.prototype.slice.call(arguments,1);try{e.apply(null,n)}catch(r){t(r)}}}},r.run=function(e){try{e()}catch(r){t(r)}return this},r.dispose=function(){return this.removeAllListeners(),this},r.enter=r.exit=function(){return this},r},r}.call(this)},{events:8}],8:[function(t,e,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!o(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,r,n,o,u,h;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[t],a(r))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),u=1;n>u;u++)o[u-1]=arguments[u];r.apply(this,o)}else if(s(r)){for(n=arguments.length,o=new Array(n-1),u=1;n>u;u++)o[u-1]=arguments[u];for(h=r.slice(),n=h.length,u=0;n>u;u++)h[u].apply(this,o)}return!0},n.prototype.addListener=function(t,e){var r;if(!i(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned){var r;r=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var n=!1;return r.listener=e,this.on(t,r),this},n.prototype.removeListener=function(t,e){var r,n,o,a;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],o=r.length,n=-1,r===e||i(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(r)){for(a=o;a-->0;)if(r[a]===e||r[a].listener&&r[a].listener===e){n=a;break}if(0>n)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],i(r))this.removeListener(t,r);else for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.listenerCount=function(t,e){var r;return r=t._events&&t._events[e]?i(t._events[e])?1:t._events[e].length:0}},{}],9:[function(t,e,r){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},{}],10:[function(t,e,r){e.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},{}],11:[function(t,e,r){function n(){if(!a){a=!0;for(var t,e=s.length;e;){t=s,s=[];for(var r=-1;++r<e;)t[r]();e=s.length}a=!1}}function i(){}var o=e.exports={},s=[],a=!1;o.nextTick=function(t){s.push(t),a||setTimeout(n,0)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=i,o.addListener=i,o.once=i,o.off=i,o.removeListener=i,o.removeAllListeners=i,o.emit=i,o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],12:[function(t,e,r){e.exports=t("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":13}],13:[function(t,e,r){(function(r){function n(t){return this instanceof n?(u.call(this,t),h.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new n(t)}function i(){this.allowHalfOpen||this._writableState.ended||r.nextTick(this.end.bind(this))}function o(t,e){for(var r=0,n=t.length;n>r;r++)e(t[r],r)}e.exports=n;var s=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e},a=t("core-util-is");a.inherits=t("inherits");var u=t("./_stream_readable"),h=t("./_stream_writable");a.inherits(n,u),o(s(h.prototype),function(t){n.prototype[t]||(n.prototype[t]=h.prototype[t])})}).call(this,t("_process"))},{"./_stream_readable":15,"./_stream_writable":17,_process:11,"core-util-is":18,inherits:9}],14:[function(t,e,r){function n(t){return this instanceof n?void i.call(this,t):new n(t)}e.exports=n;var i=t("./_stream_transform"),o=t("core-util-is");o.inherits=t("inherits"),o.inherits(n,i),n.prototype._transform=function(t,e,r){r(null,t)}},{"./_stream_transform":16,"core-util-is":18,inherits:9}],15:[function(t,e,r){(function(r){function n(e,r){var n=t("./_stream_duplex");e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,r instanceof n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(_||(_=t("string_decoder/").StringDecoder),this.decoder=new _(e.encoding),this.encoding=e.encoding)}function i(e){t("./_stream_duplex");return this instanceof i?(this._readableState=new n(e,this),this.readable=!0,void I.call(this)):new i(e)}function o(t,e,r,n,i){var o=h(e,r);if(o)t.emit("error",o);else if(C.isNullOrUndefined(r))e.reading=!1,e.ended||c(t,e);else if(e.objectMode||r&&r.length>0)if(e.ended&&!i){var a=new Error("stream.push() after EOF");t.emit("error",a)}else if(e.endEmitted&&i){var a=new Error("stream.unshift() after end event");t.emit("error",a)}else!e.decoder||i||n||(r=e.decoder.write(r)),i||(e.reading=!1),e.flowing&&0===e.length&&!e.sync?(t.emit("data",r),t.read(0)):(e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&f(t)),l(t,e);else i||(e.reading=!1);return s(e)}function s(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}function a(t){if(t>=A)t=A;else{t--;for(var e=1;32>e;e<<=1)t|=t>>e;t++}return t}function u(t,e){return 0===e.length&&e.ended?0:e.objectMode?0===t?0:1:isNaN(t)||C.isNull(t)?e.flowing&&e.buffer.length?e.buffer[0].length:e.length:0>=t?0:(t>e.highWaterMark&&(e.highWaterMark=a(t)),t>e.length?e.ended?e.length:(e.needReadable=!0,0):t)}function h(t,e){var r=null;return C.isBuffer(e)||C.isString(e)||C.isNullOrUndefined(e)||t.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function c(t,e){if(e.decoder&&!e.ended){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,f(t)}function f(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(L("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?r.nextTick(function(){p(t)}):p(t))}function p(t){L("emit readable"),t.emit("readable"),x(t)}function l(t,e){e.readingMore||(e.readingMore=!0,r.nextTick(function(){d(t,e)}))}function d(t,e){for(var r=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(L("maybeReadMore read 0"),t.read(0),r!==e.length);)r=e.length;e.readingMore=!1}function m(t){return function(){var e=t._readableState;L("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&N.listenerCount(t,"data")&&(e.flowing=!0,x(t))}}function g(t,e){e.resumeScheduled||(e.resumeScheduled=!0,r.nextTick(function(){y(t,e)}))}function y(t,e){e.resumeScheduled=!1,t.emit("resume"),x(t),e.flowing&&!e.reading&&t.read(0)}function x(t){var e=t._readableState;if(L("flow",e.flowing),e.flowing)do var r=t.read();while(null!==r&&e.flowing)}function v(t,e){var r,n=e.buffer,i=e.length,o=!!e.decoder,s=!!e.objectMode;if(0===n.length)return null;if(0===i)r=null;else if(s)r=n.shift();else if(!t||t>=i)r=o?n.join(""):O.concat(n,i),n.length=0;else if(t<n[0].length){var a=n[0];r=a.slice(0,t),n[0]=a.slice(t)}else if(t===n[0].length)r=n.shift();else{r=o?"":new O(t);for(var u=0,h=0,c=n.length;c>h&&t>u;h++){var a=n[0],f=Math.min(t-u,a.length);o?r+=a.slice(0,f):a.copy(r,u,0,f),f<a.length?n[0]=a.slice(f):n.shift(),u+=f}}return r}function w(t){var e=t._readableState;if(e.length>0)throw new Error("endReadable called on non-empty stream");e.endEmitted||(e.ended=!0,r.nextTick(function(){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}))}function b(t,e){for(var r=0,n=t.length;n>r;r++)e(t[r],r)}function S(t,e){for(var r=0,n=t.length;n>r;r++)if(t[r]===e)return r;return-1}e.exports=i;var E=t("isarray"),O=t("buffer").Buffer;i.ReadableState=n;var N=t("events").EventEmitter;N.listenerCount||(N.listenerCount=function(t,e){return t.listeners(e).length});var I=t("stream"),C=t("core-util-is");C.inherits=t("inherits");var _,L=t("util");L=L&&L.debuglog?L.debuglog("stream"):function(){},C.inherits(i,I),i.prototype.push=function(t,e){var r=this._readableState;return C.isString(t)&&!r.objectMode&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=new O(t,e),e="")),o(this,r,t,e,!1)},i.prototype.unshift=function(t){var e=this._readableState;return o(this,e,t,"",!0)},i.prototype.setEncoding=function(e){return _||(_=t("string_decoder/").StringDecoder),this._readableState.decoder=new _(e),this._readableState.encoding=e,this};var A=8388608;i.prototype.read=function(t){L("read",t);var e=this._readableState,r=t;if((!C.isNumber(t)||t>0)&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return L("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?w(this):f(this),null;if(t=u(t,e),0===t&&e.ended)return 0===e.length&&w(this),null;var n=e.needReadable;L("need readable",n),(0===e.length||e.length-t<e.highWaterMark)&&(n=!0,L("length less than watermark",n)),(e.ended||e.reading)&&(n=!1,L("reading or ended",n)),n&&(L("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1),n&&!e.reading&&(t=u(r,e));var i;return i=t>0?v(t,e):null,C.isNull(i)&&(e.needReadable=!0,t=0),e.length-=t,0!==e.length||e.ended||(e.needReadable=!0),r!==t&&e.ended&&0===e.length&&w(this),C.isNull(i)||this.emit("data",i),i},i.prototype._read=function(t){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(t,e){function n(t){
L("onunpipe"),t===f&&o()}function i(){L("onend"),t.end()}function o(){L("cleanup"),t.removeListener("close",u),t.removeListener("finish",h),t.removeListener("drain",g),t.removeListener("error",a),t.removeListener("unpipe",n),f.removeListener("end",i),f.removeListener("end",o),f.removeListener("data",s),!p.awaitDrain||t._writableState&&!t._writableState.needDrain||g()}function s(e){L("ondata");var r=t.write(e);!1===r&&(L("false write response, pause",f._readableState.awaitDrain),f._readableState.awaitDrain++,f.pause())}function a(e){L("onerror",e),c(),t.removeListener("error",a),0===N.listenerCount(t,"error")&&t.emit("error",e)}function u(){t.removeListener("finish",h),c()}function h(){L("onfinish"),t.removeListener("close",u),c()}function c(){L("unpipe"),f.unpipe(t)}var f=this,p=this._readableState;switch(p.pipesCount){case 0:p.pipes=t;break;case 1:p.pipes=[p.pipes,t];break;default:p.pipes.push(t)}p.pipesCount+=1,L("pipe count=%d opts=%j",p.pipesCount,e);var l=(!e||e.end!==!1)&&t!==r.stdout&&t!==r.stderr,d=l?i:o;p.endEmitted?r.nextTick(d):f.once("end",d),t.on("unpipe",n);var g=m(f);return t.on("drain",g),f.on("data",s),t._events&&t._events.error?E(t._events.error)?t._events.error.unshift(a):t._events.error=[a,t._events.error]:t.on("error",a),t.once("close",u),t.once("finish",h),t.emit("pipe",f),p.flowing||(L("pipe resume"),f.resume()),t},i.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this),this);if(!t){var r=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var i=0;n>i;i++)r[i].emit("unpipe",this);return this}var i=S(e.pipes,t);return-1===i?this:(e.pipes.splice(i,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this),this)},i.prototype.on=function(t,e){var n=I.prototype.on.call(this,t,e);if("data"===t&&!1!==this._readableState.flowing&&this.resume(),"readable"===t&&this.readable){var i=this._readableState;if(!i.readableListening)if(i.readableListening=!0,i.emittedReadable=!1,i.needReadable=!0,i.reading)i.length&&f(this,i);else{var o=this;r.nextTick(function(){L("readable nexttick read 0"),o.read(0)})}}return n},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){var t=this._readableState;return t.flowing||(L("resume"),t.flowing=!0,t.reading||(L("resume read 0"),this.read(0)),g(this,t)),this},i.prototype.pause=function(){return L("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(L("pause"),this._readableState.flowing=!1,this.emit("pause")),this},i.prototype.wrap=function(t){var e=this._readableState,r=!1,n=this;t.on("end",function(){if(L("wrapped end"),e.decoder&&!e.ended){var t=e.decoder.end();t&&t.length&&n.push(t)}n.push(null)}),t.on("data",function(i){if(L("wrapped data"),e.decoder&&(i=e.decoder.write(i)),i&&(e.objectMode||i.length)){var o=n.push(i);o||(r=!0,t.pause())}});for(var i in t)C.isFunction(t[i])&&C.isUndefined(this[i])&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return b(o,function(e){t.on(e,n.emit.bind(n,e))}),n._read=function(e){L("wrapped _read",e),r&&(r=!1,t.resume())},n},i._fromList=v}).call(this,t("_process"))},{"./_stream_duplex":13,_process:11,buffer:3,"core-util-is":18,events:8,inherits:9,isarray:10,stream:23,"string_decoder/":24,util:2}],16:[function(t,e,r){function n(t,e){this.afterTransform=function(t,r){return i(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function i(t,e,r){var n=t._transformState;n.transforming=!1;var i=n.writecb;if(!i)return t.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,u.isNullOrUndefined(r)||t.push(r),i&&i(e);var o=t._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&t._read(o.highWaterMark)}function o(t){if(!(this instanceof o))return new o(t);a.call(this,t),this._transformState=new n(t,this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){u.isFunction(this._flush)?this._flush(function(t){s(e,t)}):s(e)})}function s(t,e){if(e)return t.emit("error",e);var r=t._writableState,n=t._transformState;if(r.length)throw new Error("calling transform done when ws.length != 0");if(n.transforming)throw new Error("calling transform done when still transforming");return t.push(null)}e.exports=o;var a=t("./_stream_duplex"),u=t("core-util-is");u.inherits=t("inherits"),u.inherits(o,a),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,a.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,r){throw new Error("not implemented")},o.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;u.isNull(e.writechunk)||!e.writecb||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))}},{"./_stream_duplex":13,"core-util-is":18,inherits:9}],17:[function(t,e,r){(function(r){function n(t,e,r){this.chunk=t,this.encoding=e,this.callback=r}function i(e,r){var n=t("./_stream_duplex");e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.objectMode=!!e.objectMode,r instanceof n&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var s=e.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){l(r,t)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function o(e){var r=t("./_stream_duplex");return this instanceof o||this instanceof r?(this._writableState=new i(e,this),this.writable=!0,void E.call(this)):new o(e)}function s(t,e,n){var i=new Error("write after end");t.emit("error",i),r.nextTick(function(){n(i)})}function a(t,e,n,i){var o=!0;if(!(S.isBuffer(n)||S.isString(n)||S.isNullOrUndefined(n)||e.objectMode)){var s=new TypeError("Invalid non-string/buffer chunk");t.emit("error",s),r.nextTick(function(){i(s)}),o=!1}return o}function u(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&S.isString(e)&&(e=new b(e,r)),e}function h(t,e,r,i,o){r=u(e,r,i),S.isBuffer(r)&&(i="buffer");var s=e.objectMode?1:r.length;e.length+=s;var a=e.length<e.highWaterMark;return a||(e.needDrain=!0),e.writing||e.corked?e.buffer.push(new n(r,i,o)):c(t,e,!1,s,r,i,o),a}function c(t,e,r,n,i,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,r?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function f(t,e,n,i,o){n?r.nextTick(function(){e.pendingcb--,o(i)}):(e.pendingcb--,o(i)),t._writableState.errorEmitted=!0,t.emit("error",i)}function p(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function l(t,e){var n=t._writableState,i=n.sync,o=n.writecb;if(p(n),e)f(t,n,i,e,o);else{var s=y(t,n);s||n.corked||n.bufferProcessing||!n.buffer.length||g(t,n),i?r.nextTick(function(){d(t,n,s,o)}):d(t,n,s,o)}}function d(t,e,r,n){r||m(t,e),e.pendingcb--,n(),v(t,e)}function m(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function g(t,e){if(e.bufferProcessing=!0,t._writev&&e.buffer.length>1){for(var r=[],n=0;n<e.buffer.length;n++)r.push(e.buffer[n].callback);e.pendingcb++,c(t,e,!0,e.length,e.buffer,"",function(t){for(var n=0;n<r.length;n++)e.pendingcb--,r[n](t)}),e.buffer=[]}else{for(var n=0;n<e.buffer.length;n++){var i=e.buffer[n],o=i.chunk,s=i.encoding,a=i.callback,u=e.objectMode?1:o.length;if(c(t,e,!1,u,o,s,a),e.writing){n++;break}}n<e.buffer.length?e.buffer=e.buffer.slice(n):e.buffer.length=0}e.bufferProcessing=!1}function y(t,e){return e.ending&&0===e.length&&!e.finished&&!e.writing}function x(t,e){e.prefinished||(e.prefinished=!0,t.emit("prefinish"))}function v(t,e){var r=y(t,e);return r&&(0===e.pendingcb?(x(t,e),e.finished=!0,t.emit("finish")):x(t,e)),r}function w(t,e,n){e.ending=!0,v(t,e),n&&(e.finished?r.nextTick(n):t.once("finish",n)),e.ended=!0}e.exports=o;var b=t("buffer").Buffer;o.WritableState=i;var S=t("core-util-is");S.inherits=t("inherits");var E=t("stream");S.inherits(o,E),o.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},o.prototype.write=function(t,e,r){var n=this._writableState,i=!1;return S.isFunction(e)&&(r=e,e=null),S.isBuffer(t)?e="buffer":e||(e=n.defaultEncoding),S.isFunction(r)||(r=function(){}),n.ended?s(this,n,r):a(this,n,t,r)&&(n.pendingcb++,i=h(this,n,t,e,r)),i},o.prototype.cork=function(){var t=this._writableState;t.corked++},o.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.buffer.length||g(this,t))},o.prototype._write=function(t,e,r){r(new Error("not implemented"))},o.prototype._writev=null,o.prototype.end=function(t,e,r){var n=this._writableState;S.isFunction(t)?(r=t,t=null,e=null):S.isFunction(e)&&(r=e,e=null),S.isNullOrUndefined(t)||this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||w(this,n,r)}}).call(this,t("_process"))},{"./_stream_duplex":13,_process:11,buffer:3,"core-util-is":18,inherits:9,stream:23}],18:[function(t,e,r){(function(t){function e(t){return Array.isArray(t)}function n(t){return"boolean"==typeof t}function i(t){return null===t}function o(t){return null==t}function s(t){return"number"==typeof t}function a(t){return"string"==typeof t}function u(t){return"symbol"==typeof t}function h(t){return void 0===t}function c(t){return f(t)&&"[object RegExp]"===y(t)}function f(t){return"object"==typeof t&&null!==t}function p(t){return f(t)&&"[object Date]"===y(t)}function l(t){return f(t)&&("[object Error]"===y(t)||t instanceof Error)}function d(t){return"function"==typeof t}function m(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function g(e){return t.isBuffer(e)}function y(t){return Object.prototype.toString.call(t)}r.isArray=e,r.isBoolean=n,r.isNull=i,r.isNullOrUndefined=o,r.isNumber=s,r.isString=a,r.isSymbol=u,r.isUndefined=h,r.isRegExp=c,r.isObject=f,r.isDate=p,r.isError=l,r.isFunction=d,r.isPrimitive=m,r.isBuffer=g}).call(this,t("buffer").Buffer)},{buffer:3}],19:[function(t,e,r){e.exports=t("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":14}],20:[function(t,e,r){r=e.exports=t("./lib/_stream_readable.js"),r.Stream=t("stream"),r.Readable=r,r.Writable=t("./lib/_stream_writable.js"),r.Duplex=t("./lib/_stream_duplex.js"),r.Transform=t("./lib/_stream_transform.js"),r.PassThrough=t("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":13,"./lib/_stream_passthrough.js":14,"./lib/_stream_readable.js":15,"./lib/_stream_transform.js":16,"./lib/_stream_writable.js":17,stream:23}],21:[function(t,e,r){e.exports=t("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":16}],22:[function(t,e,r){e.exports=t("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":17}],23:[function(t,e,r){function n(){i.call(this)}e.exports=n;var i=t("events").EventEmitter,o=t("inherits");o(n,i),n.Readable=t("readable-stream/readable.js"),n.Writable=t("readable-stream/writable.js"),n.Duplex=t("readable-stream/duplex.js"),n.Transform=t("readable-stream/transform.js"),n.PassThrough=t("readable-stream/passthrough.js"),n.Stream=n,n.prototype.pipe=function(t,e){function r(e){t.writable&&!1===t.write(e)&&h.pause&&h.pause()}function n(){h.readable&&h.resume&&h.resume()}function o(){c||(c=!0,t.end())}function s(){c||(c=!0,"function"==typeof t.destroy&&t.destroy())}function a(t){if(u(),0===i.listenerCount(this,"error"))throw t}function u(){h.removeListener("data",r),t.removeListener("drain",n),h.removeListener("end",o),h.removeListener("close",s),h.removeListener("error",a),t.removeListener("error",a),h.removeListener("end",u),h.removeListener("close",u),t.removeListener("close",u)}var h=this;h.on("data",r),t.on("drain",n),t._isStdio||e&&e.end===!1||(h.on("end",o),h.on("close",s));var c=!1;return h.on("error",a),t.on("error",a),h.on("end",u),h.on("close",u),t.on("close",u),t.emit("pipe",h),t}},{events:8,inherits:9,"readable-stream/duplex.js":12,"readable-stream/passthrough.js":19,"readable-stream/readable.js":20,"readable-stream/transform.js":21,"readable-stream/writable.js":22}],24:[function(t,e,r){function n(t){if(t&&!u(t))throw new Error("Unknown encoding: "+t)}function i(t){return t.toString(this.encoding)}function o(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function s(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}var a=t("buffer").Buffer,u=a.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},h=r.StringDecoder=function(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),n(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=s;break;default:return void(this.write=i)}this.charBuffer=new a(6),this.charReceived=0,this.charLength=0};h.prototype.write=function(t){for(var e="";this.charLength;){var r=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";t=t.slice(r,t.length),e=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var n=e.charCodeAt(e.length-1);if(!(n>=55296&&56319>=n)){if(this.charReceived=this.charLength=0,0===t.length)return e;break}this.charLength+=this.surrogateSize,e=""}this.detectIncompleteChar(t);var i=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,i),i-=this.charReceived),e+=t.toString(this.encoding,0,i);var i=e.length-1,n=e.charCodeAt(i);if(n>=55296&&56319>=n){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),t.copy(this.charBuffer,0,0,o),e.substring(0,i)}return e},h.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var r=t[t.length-e];if(1==e&&r>>5==6){this.charLength=2;break}if(2>=e&&r>>4==14){this.charLength=3;break}if(3>=e&&r>>3==30){this.charLength=4;break}}this.charReceived=e},h.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var r=this.charReceived,n=this.charBuffer,i=this.encoding;e+=n.slice(0,r).toString(i)}return e}},{buffer:3}],25:[function(t,e,r){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],26:[function(t,e,r){(function(e,n){function i(t,e){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),m(e)?n.showHidden=e:e&&r._extend(n,e),b(n.showHidden)&&(n.showHidden=!1),b(n.depth)&&(n.depth=2),b(n.colors)&&(n.colors=!1),b(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),u(n,t,n.depth)}function o(t,e){var r=i.styles[e];return r?"["+i.colors[r][0]+"m"+t+"["+i.colors[r][1]+"m":t}function s(t,e){return t}function a(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}function u(t,e,n){if(t.customInspect&&e&&I(e.inspect)&&e.inspect!==r.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(n,t);return v(i)||(i=u(t,i,n)),i}var o=h(t,e);if(o)return o;var s=Object.keys(e),m=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),N(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return c(e);if(0===s.length){if(I(e)){var g=e.name?": "+e.name:"";return t.stylize("[Function"+g+"]","special")}if(S(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(O(e))return t.stylize(Date.prototype.toString.call(e),"date");if(N(e))return c(e)}var y="",x=!1,w=["{","}"];if(d(e)&&(x=!0,w=["[","]"]),I(e)){var b=e.name?": "+e.name:"";y=" [Function"+b+"]"}if(S(e)&&(y=" "+RegExp.prototype.toString.call(e)),O(e)&&(y=" "+Date.prototype.toUTCString.call(e)),N(e)&&(y=" "+c(e)),0===s.length&&(!x||0==e.length))return w[0]+y+w[1];if(0>n)return S(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var E;return E=x?f(t,e,n,m,s):s.map(function(r){return p(t,e,n,m,r,x)}),t.seen.pop(),l(E,y,w)}function h(t,e){if(b(e))return t.stylize("undefined","undefined");if(v(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return x(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,r,n,i){for(var o=[],s=0,a=e.length;a>s;++s)o.push(k(e,String(s))?p(t,e,r,n,String(s),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||o.push(p(t,e,r,n,i,!0))}),o}function p(t,e,r,n,i,o){var s,a,h;if(h=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},h.get?a=h.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):h.set&&(a=t.stylize("[Setter]","special")),k(n,i)||(s="["+i+"]"),a||(t.seen.indexOf(h.value)<0?(a=g(r)?u(t,h.value,null):u(t,h.value,r-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),b(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function l(t,e,r){var n=0,i=t.reduce(function(t,e){return n++,e.indexOf("\n")>=0&&n++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}function d(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function g(t){return null===t}function y(t){return null==t}function x(t){return"number"==typeof t}function v(t){return"string"==typeof t}function w(t){return"symbol"==typeof t}function b(t){return void 0===t}function S(t){return E(t)&&"[object RegExp]"===_(t)}function E(t){return"object"==typeof t&&null!==t}function O(t){return E(t)&&"[object Date]"===_(t)}function N(t){return E(t)&&("[object Error]"===_(t)||t instanceof Error)}function I(t){return"function"==typeof t}function C(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function _(t){return Object.prototype.toString.call(t)}function L(t){return 10>t?"0"+t.toString(10):t.toString(10)}function A(){var t=new Date,e=[L(t.getHours()),L(t.getMinutes()),L(t.getSeconds())].join(":");return[t.getDate(),M[t.getMonth()],e].join(" ")}function k(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var J=/%[sdj%]/g;r.format=function(t){if(!v(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(i(arguments[r]));return e.join(" ")}for(var r=1,n=arguments,o=n.length,s=String(t).replace(J,function(t){if("%%"===t)return"%";if(r>=o)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return t}}),a=n[r];o>r;a=n[++r])s+=g(a)||!E(a)?" "+a:" "+i(a);return s},r.deprecate=function(t,i){function o(){if(!s){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),s=!0}return t.apply(this,arguments)}if(b(n.process))return function(){return r.deprecate(t,i).apply(this,arguments)};if(e.noDeprecation===!0)return t;var s=!1;return o};var R,T={};r.debuglog=function(t){if(b(R)&&(R=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!T[t])if(new RegExp("\\b"+t+"\\b","i").test(R)){var n=e.pid;T[t]=function(){var e=r.format.apply(r,arguments);console.error("%s %d: %s",t,n,e)}}else T[t]=function(){};return T[t]},r.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=d,r.isBoolean=m,r.isNull=g,r.isNullOrUndefined=y,r.isNumber=x,r.isString=v,r.isSymbol=w,r.isUndefined=b,r.isRegExp=S,r.isObject=E,r.isDate=O,r.isError=N,r.isFunction=I,r.isPrimitive=C,r.isBuffer=t("./support/isBuffer");var M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];r.log=function(){console.log("%s - %s",A(),r.format.apply(r,arguments))},r.inherits=t("inherits"),r._extend=function(t,e){if(!e||!E(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":25,_process:11,inherits:9}],27:[function(t,e,r){(function(e){r.executor=t("./lib/executor"),r.filesystem=t("./lib/filesystem"),r.functions=t("./lib/functions"),r.parser=t("./lib/parser"),r.IOInterface=t("./lib/IOInterface"),r.repl=t("./lib/repl"),r.util=t("./lib/util");var n=t("./lib/IOInterface"),i=new n;i.setOutput(function(t){throw new Error("No drawing interface")}),i.setInput(function(){throw new Error("No drawing interface")}),n.set("draw",i),r.run=function(t,n,i){i||n instanceof r.executor.ExecutionContext||(i=n,n=new r.executor.ExecutionContext);var o=r.parser.parse(t);if(o.error)return i&&e.nextTick(function(){i(o.error)}),n;try{r.executor.execute(o,n,i)}catch(s){return i(s),n}return n}}).call(this,t("_process"))},{"./lib/IOInterface":28,"./lib/executor":31,"./lib/filesystem":34,"./lib/functions":36,"./lib/parser":95,"./lib/repl":127,"./lib/util":128,_process:11}],28:[function(t,e,r){(function(r){function n(t,e,r){this._output=t||function(){},this._input=e||function(t){t("\n")},this._data=r||{}}{var i=t("./util");t("stream")}n.IOInterface=n,n.prototype.setOutput=function(t){this._output=t},n.prototype.setInput=function(t){this._input=t},n.prototype.write=function(t){if("function"!=typeof this._output)throw new Error("output is not a function");this._output.call(this._data,t)},n.prototype.writeln=function(t){this.write(t+"\n")},n.prototype.log=n.prototype.writeln,n.prototype.read=function(t){function e(e,o){if(i){o&&(r=e+" ");for(var s=0;s<e.length;s++){var a=[e[s]];"string"==typeof e[s]&&(o||(r+=e[s]),a.push(r)),a.push(function(){n._input.call(n._data,!1),i=!1}),t.apply({},a)}}}if("function"!=typeof this._input)throw new Error("input is not a function");var r="",n=this,i=!0;e.cancel=function(){n._input.call(n._data,!1),i=!1},n._input.call(n._data,e)},n.prototype.readln=function(t){this.read(function(e,r,n){if("\n"===e){n();var i=r.substring(0,r.length-2);t(i)}})},n.prototype.question=function(t,e){this.write(t),this.readln(e)};var o={},s={};n.set=function(t,e){if(!(e instanceof n))throw new Error("Interface is not an instance of IOInterface");if(t=t.toLowerCase(),o[t]=e,s[t]&&s[t].length)for(var r=0;r<s[t].length;r++)s[t][r]()},n.get=function(t,e){t=t.toLowerCase();var r;if(o[t]){var a=o[t];r=new n(a._output,a._input,i.shallowClone(a._data))}else r=n.getDefault();return e!==!1&&(s[t]||(s[t]=[]),s[t].push(function(){var e=n.get(t,!1);r._output=e._output,r._input=e._input,r._data=e._data})),r},n.setDefault=function(t){n.set("default",t)},n.getDefault=function(){return this.get("default")};var a=new n;r.browser?(a._data.accumulator="",a.setOutput(function(t){this.accumulator+=t;var e=this.accumulator.split("\n");e.length>1&&(""===e[e.length-1]&&(this.accumulator=this.accumulator.substring(0,this.accumulator.length-1)),console.log(this.accumulator),this.accumulator="")})):(r.stdin.setEncoding("utf8"),a.setOutput(function(t){r.stdout.write(t)}),a.setInput(function(t){t?(this.reader&&r.stdin.removeListener("readable",this.reader),this.reader=function(){var e=r.stdin.read();null!=e&&t(e)},r.stdin.on("readable",this.reader)):r.stdin.removeListener("readable",this.reader)})),n.setDefault(a),e.exports=n}).call(this,t("_process"))},{"./util":128,_process:11,stream:23}],29:[function(t,e,r){(function(r){function n(e){p.call(this),this.stringVars={},this.numberVars={},this.pointers={},this.gosubs=[],this["private"]={rnd_seed:Math.random(),sprites:[],data:[]},this.constants=t("./constants"),this.running=!1,e=e||{},this.options=e,"undefined"==typeof e.delay&&(e.delay=!1);for(var r in a)a.hasOwnProperty(r)&&(this.constants[r]=a[r]);this.constants=f.shallowClone(this.constants)}function i(t,e,r,n){var o=e[0].execute(n);if(n.validate(o,"number"),o-=1,0>o&&(o=0),t.length<=o)throw new Error("Invalid array bounds");var s=t[o];if(e.length>1){if(!Array.isArray(s))throw new Error("Invalid array dimensions");return i(t[o],e.slice(1),r,n)}t[o]=r}function o(t,e,r){var n=e[0];if(r.validate(n,"number"),n=Math.max(0,Math.floor(n-1)),t.length<=n)throw new Error("Invalid array bounds");var i=t[n];if(e.length>1){if(!Array.isArray(i))throw new Error("Invalid array dimensions");return o(t[n],e.slice(1),r)}return i}function s(t,e){for(var r=t[0],n=new Array(r),i=0;r>i;i++){var o=e;t.length>1&&(o=s(t.slice(1),e)),n[i]=o}return n}var a=t("../functions"),u=t("../parser/statements"),h=t("domain"),c=t("util"),f=t("../util"),p=t("events").EventEmitter;c.inherits(n,p),n.prototype.execute=function(t,e,n){this.root=t,this.labels=e,this.cursor=this.options.cursorStart||0,this.running=!0,this.domain=h.create();var i=this;this.done=function(t){console.log("done!"),i.emit("terminated",t),n&&n.apply(this,arguments)},this.error=!1,this.domain.on("error",function(t){i.error=t,i.emit("error",t),i.running=!1,n(t)}),this.domain.run(function(){r.nextTick(function(){i.nextLine()})})},n.prototype.nextLine=function(){if(this.emit("beforeLine"),this.cursor=this.cursor.valueOf(),this.root.length<=this.cursor&&this.terminate(),!this.running)return void this.done(this.error);if(this.emit("line",this.root[this.cursor]),this.root.length<=this.cursor)return this.terminate(),void this.done();var t=this.root[this.cursor],e=t.execute(this),r=this;this.cursor++,"function"==typeof e?e(function(t){t&&(r.error=new Error(t.message+" on line "+r.cursor),r.terminate()),r.nextLine()}):this.nextLine()},n.prototype.validate=function(t,e){if(typeof t!==e)throw new Error("Types mismatch")},n.prototype.setVariable=function(t,e){var r="string"===t.type?this.stringVars:this.numberVars;if(e.error)throw e.error;var n=e;if(e instanceof u.ExpressionStatement&&(n=e.execute(this)),"string"===t.type)n=String(n);else if(n=parseFloat(n),isNaN(n))throw new Error("Types mismatch");var o,s;if(t instanceof u.FunctionStatement){if(!Array.isArray(r[t.name]))throw new Error("Invalid operation");o=!0,s=t.args}else o=t.isArray,s=t.dimensions;o?i(r[t.name],s,n,this):r[t.name]=n},n.prototype.getVariable=function(t){var e;if("string"===t.type&&"undefined"!=typeof this.constants[t.name+"$"])e=this.constants[t.name+"$"];else if("number"===t.type&&"undefined"!=typeof this.constants[t.name])e=this.constants[t.name];else if("string"===t.type&&"function"==typeof this.constants[t.name.toLowerCase()+"$"])e=this.constants[t.name.toLowerCase()+"$"];else if("number"===t.type&&"function"==typeof this.constants[t.name.toLowerCase()])e=this.constants[t.name.toLowerCase()];else{var r="string"===t.type?this.stringVars:this.numberVars;if(t.isArray)return o(r[t.name],t.dimensions,this);if("undefined"==typeof r[t.name])return"string"===t.type?"":0;e=r[t.name]}return"function"==typeof e?e.call(this):e},n.prototype.getPointer=function(t){var e=this.pointers[t.id];if("undefined"==typeof e)throw new Error("Invalid pointer");return e},n.prototype.setPointer=function(t,e){this.pointers[t.id]=e},n.prototype.setConstant=function(t,e){this.constants[t]=e},n.prototype.getPrivate=function(t){return this["private"][t]},n.prototype.setPrivate=function(t,e){this["private"][t]=e},n.prototype.defineArray=function(t,e){var r="number";"$"===t[t.length-1]&&(r="string",t=t.substring(0,t.length-1));var n=s(e,"string"===r?"":0),i="string"===r?this.stringVars:this.numberVars;i[t]=n},n.prototype.callFunction=function(t,e){var r=t.name+("string"===t.type?"$":""),n=this.constants[r.toLowerCase()];if(!n){var i="string"===t.type?this.stringVars:this.numberVars,s=i[t.name];if(Array.isArray(s))return o(s,e,this);throw new Error("Unknown function "+r)}return n.apply(this,e)},n.prototype.callCommand=function(t){function e(e){try{t.execute(r,e)}catch(n){e(n)}}var r=this,n=r.options.delay;if(n!==!1){var i=e;e=function(t){setTimeout(function(){i(t)},n)}}return e},n.prototype.gosubLabel=function(t){if(t=t.toLowerCase(),"undefined"==typeof this.labels[t])throw new Error('Undefined label "'+t+'"');this.gosubs.push(this.cursor),this.cursor=this.labels[t]},n.prototype.gotoLabel=function(t){if(t=t.toLowerCase(),"undefined"==typeof this.labels[t])throw new Error('Undefined label "'+t+'"');this.cursor=this.labels[t]},n.prototype.returnLabel=function(){if(!this.gosubs.length)throw new Error("RETURN without GOSUB");this.cursor=this.gosubs.pop()},n.prototype.terminate=function(){this.running=!1},e.exports=n}).call(this,t("_process"))},{"../functions":36,"../parser/statements":107,"../util":128,"./constants":30,_process:11,domain:7,events:8,util:26}],30:[function(t,e,r){var n=t("../util"),i=["January","February","March","April","May","June","July","August","September","October","November","December"],o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];e.exports={PI:Math.PI,TWO_PI:2*Math.PI,HALF_PI:Math.PI/2,EOF:0,BColorR:0,BColorG:0,BColorB:0,TColorR:0,TColorG:1,TColorB:0,ColorR:0,ColorG:1,ColorB:0,ColorA:1,IsRetina:0,IsPhone:0,IsPad:0,TickCount:function(){return n.now()},DATE$:function(){var t=new Date;return t.getDate()+" "+i[t.getMonth()].substring(0,3)+" "+t.getFullYear()},TIME$:function(){var t=new Date,e=!0,r=t.getHours();return r>12&&(r-=12,e=!1),n.pad(r,2,"0")+":"+n.pad(t.getMinutes(),2,"0")+":"+n.pad(t.getSeconds(),2,"0")+(e?" am":" pm")},DateYear:function(){return(new Date).getFullYear()},DateMonth:function(){return(new Date).getMonth()+1},DateMonth$:function(){return i[(new Date).getMonth()]},DateDay:function(){return(new Date).getDate()},DateWeekDay$:function(){return o[(new Date).getDay()]},TimeHours:function(){var t=(new Date).getHours();return 0===t&&(t=24),t},TimeMinutes:function(){return(new Date).getMinutes()},TimeSeconds:function(){return(new Date).getSeconds()}}},{"../util":128}],31:[function(t,e,r){function n(t,e,r){r||e instanceof i||(r=e,e=new i),t.execute(e,r)}var i=t("./ExecutionContext"),o=t("./constants");r.execute=n,r.ExecutionContext=i,r.constants=o},{"./ExecutionContext":29,"./constants":30}],32:[function(t,e,r){function n(t,e){this.name=t,this.root=e}var i=t("./File"),o=t("./");n.prototype.open=function(t){return this.root[t]||(this.root[t]=[]),new i(t,this.root[t],this)},n.prototype.save=function(t){o.save(t)},e.exports=n},{"./":34,"./File":33}],33:[function(t,e,r){function n(t,e,r){this.name=t,this.file=e,this.parent=r,this.readCursor=0,this.eof=!1}n.prototype.set=function(t){this.parent.root[this.name]=this.file=String(t).split("\n")},n.prototype.clear=function(){this.parent.root[this.name]=this.file=[]},n.prototype.nextLine=function(){if(this.eof||this.readCursor>=this.file.length)return this.eof=!0,"";var t=this.file[this.readCursor];return this.readCursor++,t},n.prototype.moveTo=function(t){this.readCursor=t,this.eof=this.readCursor>=this.file.length},n.prototype.write=function(t){for(var e=String(t).split("\n"),r=0;r<e.length;r++)this.file.push(e[r]);

},n.prototype.save=function(t){this.parent.save(t)},e.exports=n},{}],34:[function(t,e,r){(function(e,n){function i(t){t=t||function(){},f&&t(),u.readFile(n+"/../../data/filesystem.json",{encoding:"utf8"},function(e,r){f=e?{}:JSON.parse(r),t()})}function o(){return Boolean(f)}function s(t,e){return t=t.toLowerCase(),e=e||function(){},-1===c.indexOf(t)?e(new Error("Unknown drive")):f?(f[t]||(f[t]={}),p[t]||(p[t]=new h(t,f[t])),e(p[t]),p[t]):i(function(){s(t,e)})}function a(t){return e.browser?t():void u.writeFile(n+"/../../data/filesystem.json",JSON.stringify(f),function(e){t&&t(e)})}var u=t("fs"),h=t("./Drive"),c=["a","b"],f=e.browser?{}:!1,p={};r.Drive=h,r.File=t("./File"),r.initialize=i,r.initialized=o,r.drive=s,r.save=a}).call(this,t("_process"),"/lib\\filesystem")},{"./Drive":32,"./File":33,_process:11,fs:1}],35:[function(t,e,r){var n=t("../IOInterface").get("draw");r.touch=function(){var t=0;return n.read(function(e,r){"mousedown"===e.command&&(r(),t=e.data)}),n.write({command:"mousedown"}),t},r.touchx=function(){var t=0;return n.read(function(e,r){"mousepos"===e.command&&(r(),t=e.data.x)}),n.write({command:"mousepos"}),t},r.touchy=function(){var t=0;return n.read(function(e,r){"mousepos"===e.command&&(r(),t=e.data.y)}),n.write({command:"mousepos"}),t},r.screenwidth=function(){var t=0;return n.read(function(e,r){"screensize"===e.command&&(r(),t=e.data.width)}),n.write({command:"screensize"}),t},r.screenheight=function(){var t=0;return n.read(function(e,r){"screensize"===e.command&&(r(),t=e.data.height)}),n.write({command:"screensize"}),t},r.isportrait=function(){var t=0;return n.read(function(e,r){"screensize"===e.command&&(r(),t=e.data.height>e.data.width?1:0)}),n.write({command:"screensize"}),t},r.islandscape=function(){var t=0;return n.read(function(e,r){"screensize"===e.command&&(r(),t=e.data.height<=e.data.width?1:0)}),n.write({command:"screensize"}),t},r.accelx=function(){var t=0;return n.read(function(e,r){"accel"===e.command&&(r(),t=e.data.x)}),n.write({command:"accel"}),t},r.accely=function(){var t=0;return n.read(function(e,r){"accel"===e.command&&(r(),t=e.data.y)}),n.write({command:"accel"}),t},r.accelz=function(){var t=0;return n.read(function(e,r){"accel"===e.command&&(r(),t=e.data.z)}),n.write({command:"accel"}),t},r.spritewidth=function(t){var e=this["private"].sprites[t];if(!e)throw new Error("Invalid sprite ID");return e.width},r.spriteheight=function(t){var e=this["private"].sprites[t];if(!e)throw new Error("Invalid sprite ID");return e.height}},{"../IOInterface":28}],36:[function(t,e,r){function n(t){for(var e in t)t.hasOwnProperty(e)&&(r[e]=t[e])}n(t("./number")),n(t("./string")),n(t("./graphics"))},{"./graphics":35,"./number":37,"./string":38}],37:[function(t,e,r){function n(t){var e=1e4*Math.sin(t.getPrivate("rnd_seed"));return t.setPrivate("rnd_seed",t.getPrivate("rnd_seed")+1),e-Math.floor(e)}r.sin=function(t){return this.validate(t,"number"),Math.sin(t)},r.cos=function(t){return this.validate(t,"number"),Math.cos(t)},r.tan=function(t){return this.validate(t,"number"),Math.tan(t)},r.asin=function(t){return this.validate(t,"number"),Math.asin(t)},r.acos=function(t){return this.validate(t,"number"),Math.acos(t)},r.atn=function(t){return this.validate(t,"number"),Math.atan(t)},r.rad=function(t){return this.validate(t,"number"),Math.rad(t)},r.deg=function(t){return this.validate(t,"number"),Math.deg(t)},r.sqr=function(t){return this.validate(t,"number"),Math.sqrt(t)},r.abs=function(t){return this.validate(t,"number"),Math.abs(t)},r["int"]=function(t){return this.validate(t,"number"),Math.floor(t)},r.log=function(t){return this.validate(t,"number"),Math.log(t)},r.log10=function(t){return this.validate(t,"number"),Math.log10(t)},r.exp=function(t){return this.validate(t,"number"),Math.exp(t)},r.mod=function(t,e){return this.validate(t,"number"),this.validate(e,"number"),t%e},r.rnd=function(t,e){return"undefined"!=typeof t&&"undefined"!=typeof e?(this.validate(t,"number"),this.validate(e,"number"),Math.floor(n(this)*(e-t+1))+t):n(this)},r.randomize=function(t){this.setPrivate("rnd_seed",t)}},{}],38:[function(t,e,r){r.upper$=function(t){return this.validate(t,"string"),t.toUpperCase()},r.lower$=function(t){return this.validate(t,"string"),t.toLowerCase()},r.left$=function(t,e){return this.validate(t,"string"),this.validate(e,"number"),t.substr(0,e)},r.mid$=function(t,e,r){return this.validate(t,"string"),this.validate(e,"number"),this.validate(r,"number"),t.substr(e,r)},r.right$=function(t,e){return this.validate(t,"string"),this.validate(e,"number"),t.substr(-e)},r.len=function(t){return this.validate(t,"string"),t.length},r.val=function(t){this.validate(t,"string");var e=parseFloat(t);if(isNaN(e))throw new Error("String is not a number");return e},r.str$=function(t){return this.validate(t,"number"),t.toString()},r.asc=function(t){return this.validate(t,"string"),t.charCodeAt(0)},r.chr$=function(t){return this.validate(t,"number"),String.fromCharCode(t)},r.spc$=function(t){return this.validate(t,"number"),new Array(t+1).join(" ")}},{}],39:[function(t,e,r){function n(t,e,r){this.root=t,this.labels=e,this.manager=r,r.parse(this)}var i=t("./statements");n.prototype.toString=function(){for(var t=[],e=0;e<this.root.length;e++)t.push(this.root[e].toString());for(var r in this.labels)if(this.labels.hasOwnProperty(r)){var n=this.labels[r];t[n]=this.root[n]instanceof i.EmptyStatement?r+":":r+" "+t[n]}return t.join("\n")},n.prototype.toJSON=function(){for(var t=[],e=0;e<this.root.length;e++)t.push(this.root[e].toJSON());return{root:t,labels:this.labels}},n.prototype.execute=function(t,e){t.execute(this.root,this.labels,e)},e.exports=n},{"./statements":107}],40:[function(t,e,r){function n(t,e,r){this.startNames=[],this.thenNames=[],this.endNames=[];for(var n=0;n<e.start.length;n++)this.startNames.push(e.start[n].toLowerCase());for(var i=0;i<e.end.length;i++)this.endNames.push(e.end[i].toLowerCase());for(var o=0;o<e.then.length;o++)this.thenNames.push(e.then[o].toLowerCase());this.line=t,this.parent=r,this.searchIndex=t,this.start=-1,this.intermediateIndexes={},this.intermediateCursors={},this.end=-1}var i=t("../statements"),o=t("../SyntaxError");n.prototype.parse=function(t){for(var e=t.root,r=0,n=this.intermediateIndexes={},s=this.searchIndex;s<e.length;s++){var a=e[s];if(a instanceof i.CommandStatement){var u=a.name;if(-1!==this.startNames.indexOf(u))0===r&&(this.start=s),r++;else if(-1!==this.thenNames.indexOf(u)&&1===r)n[u]||(n[u]=[]),n[u].push(s);else if(-1!==this.endNames.indexOf(u)){if(r--,0>r)throw new o("Unexpected "+u.toUpperCase());if(0===r)return void(this.end=s)}}}if(0!==r)throw new o(this.startNames[0].toUpperCase()+" without "+this.endNames[0].toUpperCase()+" on line "+(this.start+1))},n.prototype.has=function(t){return t=t.toLowerCase(),-1===this.thenNames.indexOf(t)?!1:this.intermediateIndexes[t]?Boolean(this.intermediateIndexes[t].length):!1},n.prototype.next=function(t){if(t=t.toLowerCase(),!this.has(t))return-1;this.intermediateCursors[t]||(this.intermediateCursors[t]=0);var e=this.intermediateCursors[t];e>=this.intermediateIndexes[t].length&&(e=this.intermediateCursors[t]=0);var r=this.intermediateIndexes[t][e];return this.intermediateCursors[t]++,r},n.prototype.references=function(){return this.parent.byLineRef[this.line]},n.prototype.toJSON=function(){return{line:this.line,searchIndex:this.searchIndex,start:this.start,intermediateIndexes:this.intermediateIndexes,intermediateCursors:this.intermediateCursors,end:this.end}},e.exports=n},{"../SyntaxError":42,"../statements":107}],41:[function(t,e,r){function n(){this.children=[],this.byLineRef={}}function i(t,e,r){t[r]||(t[r]=[]),t[r].push(e)}var o=t("./Block");n.Block=o,n.BlockManager=n,n.prototype.parse=function(t){for(var e=0;e<this.children.length;e++){var r=this.children[e];r.parse(t),-1!==r.start&&i(this.byLineRef,r,r.start),-1!==r.end&&i(this.byLineRef,r,r.end);for(var n in r.intermediateIndexes)if(r.intermediateIndexes.hasOwnProperty(n))for(var o=r.intermediateIndexes[n],s=0;s<o.length;s++)i(this.byLineRef,r,o[s])}},n.prototype.create=function(t){var e=this,r=function(r){var n=Array.isArray(r.start)?r.start:[r.start],i=Array.isArray(r.end)?r.end:[r.end],s=r.then?Array.isArray(r.then)?r.then:[r.then]:[],a=new o(t,{start:n,end:i,then:s},e);return e.children.push(a),a};return r.references=function(){return e.byLineRef[t]},r.line=t,r.toJSON=function(){for(var r=[],n=e.byLineRef[t],i=0;i<n.length;i++)r.push(n[i].toJSON());return{line:t,lineRef:r}},r},e.exports=n},{"./Block":40}],42:[function(t,e,r){function n(t){this.message=t}n.prototype.toString=function(){return this.message},e.exports=n},{}],43:[function(t,e,r){function n(){}var i=t("../../IOInterface").get("draw");n.prototype.execute=function(t,e){i.write({command:"accel",args:{calibrate:!0}}),e()},e.exports=n},{"../../IOInterface":28}],44:[function(t,e,r){function n(){}n.prototype.execute=function(t,e){e()},e.exports=n},{}],45:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<3)throw new o("BCOLOR command requires 3 arguments");this.red=e.args[0],this.green=e.args[1],this.blue=e.args[2]}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../IOInterface").get("draw");n.prototype.toString=function(){return[this.red,this.green,this.blue].join(", ")},n.prototype.toJSON=function(){return{r:this.red.toJSON(),g:this.green.toJSON(),b:this.blue.toJSON()}},n.prototype.execute=function(t,e){var r=this.red.execute(t),n=this.green.execute(t),i=this.blue.execute(t);t.validate(r,"number"),t.validate(n,"number"),t.validate(i,"number");var o=r,a=n,u=i;r>1&&(r/=255),n>1&&(n/=255),i>1&&(i/=255),r=Math.max(0,Math.min(r,1)),n=Math.max(0,Math.min(n,1)),i=Math.max(0,Math.min(i,1)),t.setConstant("BColorR",o),t.setConstant("BColorG",a),t.setConstant("BColorB",u),s.write({command:"bcolor",args:{r:r,g:n,b:i}}),e()},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],46:[function(t,e,r){function n(){}var i=t("../../IOInterface").get("draw");n.prototype.execute=function(t,e){i.write({command:"startCache"}),e()},e.exports=n},{"../../IOInterface":28}],47:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<3)throw new o("CIRCLE command requires 3 arguments");this.x=e.args[0],this.y=e.args[1],this.radius=e.args[2],this.stroke=e.args.length>3?e.args[3]:!1}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../IOInterface").get("draw");n.prototype.toString=function(){var t=[this.x,this.y,this.radius];return this.stroke&&t.push(this.stroke),t.join(", ")},n.prototype.toJSON=function(){return{x:this.x.toJSON(),y:this.y.toJSON(),radius:this.radius.toJSON(),stroke:this.stroke?this.stroke.toJSON():!1}},n.prototype.execute=function(t,e){var r=this.x.execute(t),n=this.y.execute(t),i=this.radius.execute(t),o=this.stroke?this.stroke.execute(t):0;t.validate(r,"number"),t.validate(n,"number"),t.validate(i,"number"),t.validate(o,"number"),s.write({command:"circle",args:{x:r,y:n,radius:i,stroke:o}}),e()},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],48:[function(t,e,r){function n(t,e){var r=new i.ExpressionStatement(t,e);if(!(r.child instanceof i.PointerStatement))throw new o("Expected pointer");this.pointer=r}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../filesystem");n.prototype.toString=function(){return this.pointer.toString()},n.prototype.toJSON=function(){return{pointer:this.pointer.toJSON()}},n.prototype.execute=function(t,e){var r=this.pointer.execute(t);if(!(r instanceof s.File))throw new Error("Expected file");t.setPointer(this.pointer.child,!1),e()},e.exports=n},{"../../filesystem":34,"../SyntaxError":42,"../statements":107}],49:[function(t,e,r){(function(r){function n(t){var e=t.toLowerCase();this.tty="gfx"!==e,this.gfx="tty"!==e}var i=t("../../IOInterface").get("draw");n.prototype.toString=function(){return this.tty&&!this.gfx?"TTY":this.gfx&&!this.tty?"GFX":""},n.prototype.toJSON=function(){return{tty:this.tty,gfx:this.gfx}},n.prototype.execute=function(t,e){this.tty&&(r.browser?i.write({command:"clear",args:{type:"tty"}}):console.log(new Array(r.stdout.rows+1).join("\n"))),this.gfx&&r.browser&&i.write({command:"clear",args:{type:"gfx"}}),e()},e.exports=n}).call(this,t("_process"))},{"../../IOInterface":28,_process:11}],50:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<3)throw new o("COLOR command requires 3 arguments");this.red=e.args[0],this.green=e.args[1],this.blue=e.args[2],this.alpha=e.args.length>3?e.args[3]:!1}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../IOInterface").get("draw");n.prototype.toString=function(){var t=[this.red,this.green,this.blue];return this.alpha&&t.push(this.alpha),t.join(", ")},n.prototype.toJSON=function(){return{r:this.red.toJSON(),g:this.green.toJSON(),b:this.blue.toJSON(),a:this.alpha?this.alpha.toJSON():!1}},n.prototype.execute=function(t,e){var r=this.red.execute(t),n=this.green.execute(t),i=this.blue.execute(t),o=this.alpha?this.alpha.execute(t):!1;t.validate(r,"number"),t.validate(n,"number"),t.validate(i,"number"),o!==!1?t.validate(o,"number"):o=t.constants.ColorA;var a=r,u=n,h=i,c=o;r>1&&(r/=255),n>1&&(n/=255),i>1&&(i/=255),o>1&&(o/=255),r=Math.max(0,Math.min(r,1)),n=Math.max(0,Math.min(n,1)),i=Math.max(0,Math.min(i,1)),o=Math.max(0,Math.min(o,1)),t.setConstant("ColorR",a),t.setConstant("ColorG",u),t.setConstant("ColorB",h),t.setConstant("ColorA",c),s.write({properties:{r:r,g:n,b:i,a:o}}),e()},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],51:[function(t,e,r){function n(t){this.items=new i.ArgumentStatement(t).args}var i=t("../statements");n.prototype.toString=function(){return this.items.join(", ")},n.prototype.toJSON=function(){return{items:this.items}},n.prototype.execute=function(t,e){for(var r=0;r<this.items.length;r++)t["private"].data.push(this.items[r].execute(t));e()},e.exports=n},{"../statements":107}],52:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t,{parseArgs:!1});this.creates=[];for(var r=0;r<e.args.length;r++){var n=e.args[r],s=n.indexOf("("),a=n.indexOf(")");if(-1===s)throw new o("Expected start bracket");if(-1===a)throw new o("Expected end bracket");var u=n.substring(0,s).trim(),h=n.substring(s+1,a),c=new i.ArgumentStatement(h);this.creates.push({name:u,lengths:c.args})}}var i=t("../statements"),o=t("../SyntaxError");n.prototype.toString=function(){for(var t=[],e=0;e<this.creates.length;e++){var r=this.creates[e];t.push(r.name+"("+r.lengths.join(", ")+")")}return t.join(", ")},n.prototype.toJSON=function(){for(var t=[],e=0;e<this.creates.length;e++){for(var r=[],n=this.creates[e],i=0;i<n.lengths.length;i++)r.push(n.lengths[i].toJSON());t.push({name:n.name.toJSON(),lengths:r})}return{creates:t}},n.prototype.execute=function(t,e){for(var r=0;r<this.creates.length;r++){for(var n=this.creates[r],i=[],o=0;o<n.lengths.length;o++){var s=n.lengths[o].execute(t);t.validate(s,"number"),i.push(s)}t.defineArray(n.name,i)}e()},e.exports=n},{"../SyntaxError":42,"../statements":107}],53:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<3)throw new o("DRAWSPRITE command requires 3 arguments");this.id=e.args[0],this.x=e.args[1],this.y=e.args[2],this.scale=4===e.args.length?e.args[3]:!1,this.rotation=5===e.args.length?e.args[4]:!1}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../IOInterface").get("draw");n.prototype.toString=function(){var t=[this.id,this.x,this.y];return this.scale&&t.push(this.scale),this.rotation&&t.push(this.rotation),t.join(", ")},n.prototype.toJSON=function(){return{id:this.id.toJSON(),x:this.x.toJSON(),y:this.y.toJSON(),scale:this.scale?this.scale.toJSON():!1,rotation:this.rotation?this.rotation.toJSON():!1}},n.prototype.execute=function(t,e){var r=this.id.execute(t),n=this.x.execute(t),i=this.y.execute(t),o=this.scale?this.scale.execute(t):1,a=this.rotation?this.rotation.execute(t):0;if(t.validate(r,"number"),t.validate(n,"number"),t.validate(i,"number"),t.validate(o,"number"),t.validate(a,"number"),!t["private"].sprites[r])throw new Error("Invalid sprite ID");var u=t["private"].sprites[r];s.print({command:"sprite",args:{x:n,y:i,scale:o,rotation:a,sprite:u}}),e()},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],54:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<3)throw new o("DRAWTEXT command requires 3 arguments");if(e.args.length>3&&e.args.length<5)throw new o("DRAWTEXT command requires 5 arguments");this.text=e.args[0],this.x1=e.args[1],this.y1=e.args[2],e.args.length>3?(this.x2=e.args[3],this.y2=e.args[4]):(this.x2=!1,this.y2=!1)}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../IOInterface").get("draw");n.prototype.toString=function(){var t=[this.text,this.x1,this.y1];return this.x2&&t.push(this.x2,this.y2),t.join(", ")},n.prototype.toJSON=function(){return{text:this.text.toJSON(),x1:this.x1.toJSON(),y1:this.y1.toJSON(),x2:this.x2?this.x2.toJSON():!1,y2:this.y2?this.y2.toJSON():!1}},n.prototype.execute=function(t,e){var r=this.text.execute(t),n=this.x1.execute(t),i=this.y1.execute(t);t.validate(n,"number"),t.validate(i,"number");var o,a=!1;this.x2&&(o=this.x2.execute(t),a=this.y2.execute(t),t.validate(o,"number"),t.validate(a,"number")),s.write({command:"text",args:{text:r,x1:n,y1:i,x2:o,y2:a}}),e()},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],55:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<4)throw new o("ELLIPSE command requires 4 arguments");this.x1=e.args[0],this.y1=e.args[1],this.x2=e.args[2],this.y2=e.args[3],this.stroke=e.args.length>4?e.args[4]:!1}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../IOInterface").get("draw");n.prototype.toString=function(){var t=[this.x1,this.y1,this.x2,this.y2];return this.stroke&&t.push(this.stroke),t.join(", ")},n.prototype.toJSON=function(){return{x1:this.x1.toJSON(),y1:this.y1.toJSON(),x2:this.x2.toJSON(),y2:this.y2.toJSON(),stroke:this.stroke?this.stroke.toJSON():!1}},n.prototype.execute=function(t,e){var r=this.x1.execute(t),n=this.y1.execute(t),i=this.x2.execute(t),o=this.y2.execute(t),a=this.stroke?this.stroke.execute(t):0;t.validate(r,"number"),t.validate(n,"number"),t.validate(i,"number"),t.validate(o,"number"),t.validate(a,"number"),s.write({command:"ellipse",args:{x1:r,y1:n,x2:i,y2:o,stroke:a}}),e()},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],56:[function(t,e,r){function n(t,e){this.block=e}n.prototype.toJSON=function(){return{block:this.block.toJSON()}},n.prototype.execute=function(t,e){var r=this.block.references();if(!r.length)throw new Error("ELSE without IF");t.cursor=r[0].end,e()},e.exports=n},{}],57:[function(t,e,r){function n(){}t("../statements"),t("../SyntaxError");n.prototype.execute=function(t,e){t.terminate(),e()},e.exports=n},{"../SyntaxError":42,"../statements":107}],58:[function(t,e,r){function n(){}var i=t("../../IOInterface").get("draw");n.prototype.execute=function(t,e){i.write({command:"flushCache"}),e()},e.exports=n},{"../../IOInterface":28}],59:[function(t,e,r){function n(){}n.prototype.execute=function(t,e){e()},e.exports=n},{}],60:[function(t,e,r){function n(t,e){var r=t.toLowerCase(),n=r.indexOf(" to ");if(-1===n)throw new s("FOR has no TO");var o,a,u=t.substring(0,n).trim(),h=r.indexOf(" step ");-1===h?(o=t.substring(n+4).trim(),a="1"):(o=t.substring(n+4,h).trim(),a=t.substring(h+6).trim());var c=u.indexOf("=");if(-1===c)throw new s("Expected assignment");var f=u.substring(0,c).trim(),p=u.substring(c+1).trim(),l=new i.AssignmentStatement(new i.VariableStatement(f),new i.ExpressionStatement(p,e)),d=new i.ExpressionStatement(o,e);if(d.error)throw d.error;var m=new i.ExpressionStatement(a,e);if(m.error)throw m.error;this.assignmentExpr=l,this.upperLimitExpr=d,this.stepExpr=m,this.block=e({start:"FOR",end:"NEXT"}),this.loopCount=0}var i=t("../statements"),o=t("../../util"),s=t("../SyntaxError"),a=o.setImmediate,u=200;n.prototype.toString=function(){return this.assignmentExpr.toString()+" TO "+this.upperLimitExpr.toString()+" STEP "+this.stepExpr.toString()},n.prototype.toJSON=function(){return{assignment:this.assignmentExpr.toJSON(),upperLimit:this.upperLimitExpr.toJSON(),step:this.stepExpr.toJSON(),block:this.block.toJSON()}},n.prototype.execute=function(t,e){var r;if(this.hasRun){var n=this.stepExpr.execute(t);t.validate(n,"number"),r=t.getVariable(this.trackVar),t.validate(r,"number"),r+=n,t.setVariable(this.trackVar,r)}else this.hasRun=!0,this.assignmentExpr.execute(t),this.trackVar=this.assignmentExpr.variable,r=t.getVariable(this.trackVar);var i=this.upperLimitExpr.execute(t);t.validate(i,"number"),(i>0&&r>i||0>i&&i>r)&&(this.hasRun=!1,t.cursor=this.block.end+1),this.loopCount++,this.loopCount>u?(this.loopCount=0,a(e)):e()},e.exports=n},{"../../util":128,"../SyntaxError":42,"../statements":107}],61:[function(t,e,r){function n(t){if(!t.length)throw new i("Label required");this.label=t}var i=t("../SyntaxError"),o=t("../../util"),s=o.setImmediate;n.prototype.toString=function(){return this.label},n.prototype.toJSON=function(){return{label:this.label}},n.prototype.execute=function(t,e){t.gosubLabel(this.label),s(e)},e.exports=n},{"../../util":128,"../SyntaxError":42}],62:[function(t,e,r){function n(t){if(!t.length)throw new i("Label required");this.label=t}var i=t("../SyntaxError"),o=t("../../util"),s=o.setImmediate;n.prototype.toString=function(){return this.label},n.prototype.toJSON=function(){return{label:this.label}},n.prototype.execute=function(t,e){t.gotoLabel(this.label),s(e)},e.exports=n},{"../../util":128,"../SyntaxError":42}],63:[function(t,e,r){function n(t,e){if(!o.endsWith(t.toLowerCase()," then"))throw new s("IF has no THEN");t=t.slice(0,t.length-5).trim();var r=new i.ArgumentStatement(t,{separator:!1},e);this.condition=r.args[0],this.block=e({start:"IF",then:"ELSE",end:["ENDIF","RETURN"]})}var i=t("../statements"),o=t("../../util"),s=t("../SyntaxError");n.prototype.toString=function(){return this.condition.toString()+" THEN"},n.prototype.toJSON=function(){return{condition:this.condition.toJSON(),block:this.block.toJSON()}},n.prototype.execute=function(t,e){var r=this.condition.execute(t);r||(t.cursor=this.block.has("ELSE")?this.block.next("ELSE")+1:this.block.end),e()},e.exports=n},{"../../util":128,"../SyntaxError":42,"../statements":107}],64:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(!e.args.length)throw new o("INPUT requires at least one argument");var r,n,s="";if(1===e.args.length?r=e.args[0]:(e.args[0].child instanceof i.PointerStatement?n=e.args[0]:s=e.args[0],r=e.args[1]),!(r.child instanceof i.VariableStatement||r.child instanceof i.FunctionStatement))throw new o("Expected variable");this.file=n,this.question=s,this.placeVar=r}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../filesystem"),a=t("../../IOInterface").getDefault();n.prototype.toString=function(){return(this.file?this.file.toString()+", ":"")+(this.question?this.question.toString()+", ":"")+this.placeVar.toString()},n.prototype.toJSON=function(){return{file:this.file?this.file.toJSON():!1,question:this.question?this.question.toJSON():!1,variable:this.placeVar.toJSON()}},n.prototype.execute=function(t,e){var r=this.placeVar;if(this.file){var n=this.file.execute(t);if(!(n instanceof s.File))throw new Error("Expected file");if("input"!==n.mode)throw new Error("File not readable");var i=n.nextLine();n.eof&&"number"===r.child.type&&(i=0),t.setVariable(r.child,i),t.setConstant("EOF",n.eof?1:0),e()}else{var o=this.question?this.question.execute(t):"";a.question(o+"> ",function(n){t.setVariable(r.child,n),e()})}},e.exports=n},{"../../IOInterface":28,"../../filesystem":34,"../SyntaxError":42,"../statements":107}],65:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<4)throw new o("LINE command requires 4 arguments");this.x1=e.args[0],this.y1=e.args[1],this.x2=e.args[2],this.y2=e.args[3],this.width=e.args.length>4?e.args[4]:!1}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../IOInterface").get("draw");n.prototype.toString=function(){var t=[this.x1,this.y1,this.x2,this.y2];return this.width&&t.push(this.width),t.join(", ")},n.prototype.toJSON=function(){return{x1:this.x1.toJSON(),y1:this.y1.toJSON(),x2:this.x2.toJSON(),y2:this.y2.toJSON(),width:this.width?this.width.toJSON():!1}},n.prototype.execute=function(t,e){var r=this.x1.execute(t),n=this.y1.execute(t),i=this.x2.execute(t),o=this.y2.execute(t),a=this.width?this.width.execute(t):1;t.validate(r,"number"),t.validate(n,"number"),t.validate(i,"number"),t.validate(o,"number"),t.validate(a,"number"),s.write({command:"line",args:{x1:r,y1:n,x2:i,y2:o,width:a}}),e()},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],66:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<2)throw new o("LOADSPRITE command requires 2 arguments");if(e.args.length>2&&e.args.length<5)throw new o("LOADSPRITE command requires 5 arguments");this.id=e.args[0],e.args.length>2?(this.x1=e.args[1],this.y1=e.args[2],this.x2=e.args[3],this.y2=e.args[4]):this.fileName=e.args[1]}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../filesystem"),a=t("../../IOInterface").get("draw");n.prototype.toString=function(){if(this.x1){var t=[this.id,this.x1,this.y1,this.x2,this.y2];return t.join(", ")}return this.id+", "+this.fileName},n.prototype.toJSON=function(){return{id:this.id.toJSON(),x1:this.x1?this.x1.toJSON():!1,y1:this.y1?this.y1.toJSON():!1,x2:this.x2?this.x2.toJSON():!1,y2:this.y2?this.y2.toJSON():!1,fileName:this.fileName?this.fileName.toJSON():!1}},n.prototype.execute=function(t,e){var r=this.id.execute(t);if(t.validate(r,"number"),this.x1){var n=this.x1.execute(t),i=this.y1.execute(t),o=this.x2.execute(t),u=this.y2.execute(t);t.validate(n,"number"),t.validate(i,"number"),t.validate(o,"number"),t.validate(u,"number"),a.read(function(n,i){"capture"===n.command&&(i(),t["private"].sprites[r]=n.data,e())}),a.write({command:"capture",args:{x1:n,y1:i,x2:o,y2:u}})}else{var h=this.fileName.execute(t);t.validate(h,"string");var c=h.indexOf(":"),f="A";-1!==c&&(f=h.substring(0,c),h=h.substring(c+1)),s.drive(f,function(n){var i=n.open(h),o=i.nextLine();if(i.eof||!o.length)throw new Error("Invalid image file");var s=new Image;s.src=o,t["private"].sprites[r]=s,e()})}},e.exports=n},{"../../IOInterface":28,"../../filesystem":34,"../SyntaxError":42,"../statements":107}],67:[function(t,e,r){function n(){}var i=t("../../IOInterface").get("draw");n.prototype.execute=function(t,e){i.write({command:"locksize"}),e()},e.exports=n},{"../../IOInterface":28}],68:[function(t,e,r){function n(t,e){this.block=e}n.prototype.toJSON=function(){return{block:this.block.toJSON()}},n.prototype.execute=function(t,e){var r=this.block.references();if(!r.length)throw new Error("NEXT without FOR");t.cursor=r[0].start,e()},e.exports=n},{}],69:[function(t,e,r){function n(t,e){var r=t.toLowerCase(),n=r.indexOf(" for ");if(-1===n)throw new o("OPEN without FOR");var s=new i.ExpressionStatement(t.substring(0,n).trim(),e),a=r.indexOf(" as ");if(-1===a)throw new o("OPEN without AS");var u=t.substring(n+5,a).trim().toLowerCase();if("input"!==u&&"output"!==u&&"append"!==u)throw new o("Invalid mode");var h=new i.ExpressionStatement(t.substring(a+4).trim(),e);if(!(h.child instanceof i.PointerStatement))throw new o("Expected pointer");this.filename=s,this.type=u,this.pointer=h}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../filesystem");n.prototype.toString=function(){return this.filename.toString()+" FOR "+this.type.toUpperCase()+" AS "+this.pointer.toString()},n.prototype.toJSON=function(){return{filename:this.filename.toJSON(),type:this.type,pointer:this.pointer.toJSON()}},n.prototype.execute=function(t,e){var r=this.filename.execute(t);t.validate(r,"string");var n=r.indexOf(":"),i="A";-1!==n&&(i=r.substring(0,n),r=r.substring(n+1));var o=this.pointer.child,a=this.type;s.drive(i,function(n){var i=n.open(r);i.mode=a,"output"===a&&i.clear(),t.setPointer(o,i),e()})},e.exports=n},{"../../filesystem":34,"../SyntaxError":42,"../statements":107}],70:[function(t,e,r){function n(t,e){if(t.length){if(this.message=new i.ExpressionStatement(t,e),this.message.error)throw this.message.error}else this.message=new i.StringStatement("[<< Paused, Press RETURN to Continue >>]")}var i=t("../statements"),o=(t("../SyntaxError"),t("../../IOInterface").getDefault());n.prototype.toString=function(){return this.message.toString()},n.prototype.toJSON=function(){return{message:this.message.toJSON()}},n.prototype.execute=function(t,e){var r=this.message.execute(t);t.validate(r,"string"),o.question(r,function(t){e()})},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],71:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<8)throw new o("PIECHART command requires 8 arguments");this.x=e.args[0],this.y=e.args[1],this.r=e.args[2],this.itemsLength=e.args[3],this.percentages=e.args[4],this.itemsRed=e.args[5],this.itemsGreen=e.args[6],this.itemsBlue=e.args[7]}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../IOInterface").get("draw");n.prototype.toString=function(){var t=[this.x,this.y,this.r,this.itemsLength,this.percentages,this.itemsRed,this.itemsGreen,this.itemsBlue];return t.join(", ")},n.prototype.toJSON=function(){return{x:this.x.toJSON(),y:this.y.toJSON(),r:this.r.toJSON(),itemsLength:this.itemsLength.toJSON(),percentages:this.percentages.toJSON(),itemsRed:this.itemsRed.toJSON(),itemsGreen:this.itemsGreen.toJSON(),itemsBlue:this.itemsBlue.toJSON()}},n.prototype.execute=function(t,e){var r=this.x.execute(t),n=this.y.execute(t),i=this.r.execute(t),o=this.itemsLength.execute(t),a=this.percentages.execute(t),u=this.itemsRed.execute(t),h=this.itemsGreen.execute(t),c=this.itemsBlue.execute(t);if(t.validate(r,"number"),t.validate(n,"number"),t.validate(i,"number"),t.validate(o,"number"),!Array.isArray(a))throw new Error("Types mismatch");if(!Array.isArray(u))throw new Error("Types mismatch");if(!Array.isArray(h))throw new Error("Types mismatch");if(!Array.isArray(c))throw new Error("Types mismatch");if(o>a.length||o>u.length||o>h.length||o>c.length)throw new Error("Invalid array bounds");for(var f=[],p=0;o>p;p++){var l=a[p],d=u[p],m=h[p],g=c[p];t.validate(l,"number"),t.validate(d,"number"),t.validate(m,"number"),t.validate(g,"number"),f.push({size:l,r:d,g:m,b:g})}s.write({command:"piechart",args:{items:f,x:r,y:n,r:i}}),e()},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],72:[function(t,e,r){function n(){}n.prototype.execute=function(t,e){e()},e.exports=n},{}],73:[function(t,e,r){function n(){}n.prototype.execute=function(t,e){e()},e.exports=n},{}],74:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<2)throw new o("POINT command requires 2 arguments");this.x=e.args[0],this.y=e.args[1],this.size=e.args.length>2?e.args[2]:!1}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../IOInterface").get("draw");n.prototype.toString=function(){var t=[this.x,this.y];return this.size&&t.push(this.size),t.join(", ")},n.prototype.toJSON=function(){return{x:this.x.toJSON(),y:this.y.toJSON(),size:this.size?this.size.toJSON():!1}},n.prototype.execute=function(t,e){var r=this.x.execute(t),n=this.y.execute(t),i=this.size?this.size.execute(t):1;t.validate(r,"number"),t.validate(n,"number"),t.validate(i,"number"),s.write({command:"point",args:{x:r,y:n,size:i}}),e()},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],75:[function(t,e,r){function n(t,e){";"===t[t.length-1]?(this.noLine=!0,t=t.substr(-1)):this.noLine=!1;var r=new i.ArgumentStatement(t,{flags:["USING"],parseArgs:!1});if(r.flags.USING){if(1!==r.args.length)throw new o("PRINT USING command requires 1 argument");if(r.args.length>1)throw new o("Unexpected comma");var n=r.args[0].indexOf(";");if(-1===n)throw new o("Expected semicolon");var s=new i.ExpressionStatement(r.args[0].substring(0,n).trim(),e),a=new i.ExpressionStatement(r.args[0].substring(n+1).trim(),e);

if(s.error instanceof o)throw s.error;if(a.error instanceof o)throw a.error;this.formatExpr=s,this.numberExpr=a}else{for(var u=[],h=0;h<r.args.length;h++){var c=new i.ExpressionStatement(r.args[h],e);if(c.error instanceof o)throw c.error;u.push(c)}this.items=u}}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../filesystem"),a=t("../../IOInterface").getDefault();n.prototype.toString=function(){return this.formatExpr?"USING "+this.formatExpr.toString()+"; "+this.numberExpr.toString():this.items.join(", ")},n.prototype.toJSON=function(){var t=[];if(this.items)for(var e=0;e<this.items.length;e++)t.push(this.items[e].toJSON());return{format:this.formatExpr?this.formatExpr.toJSON():!1,number:this.numberExpr?this.numberExpr.toJSON():!1,items:t,noLine:this.noLine}},n.prototype.execute=function(t,e){if(this.formatExpr){var r=this.formatExpr.execute(t),n=this.numberExpr.execute(t);t.validate(r,"string"),t.validate(n,"number");var i=n.toString().split("."),o=i[0],u=i.length>1?i[1]:"",h=r.split("."),c=h[0],f=h.length>1?h[1]:"",p="",l="",d=o.length-c.length,m=o.substring(0>d?0:d);if(0>d){var g=-1*d;m=new Array(g+1).join(" ")+m}for(var y=0;y<c.length;y++){var x=c[y];p+="#"!==x?x:m[y]}var v=u.substring(0,f.length);if(v.length<f.length){var w=f.length-v.length;v+=new Array(w+1).join(" ")}for(var b=0;b<f.length;b++){var S=f[b];l+="#"!==S?S:v[b]}a.write(p+(l.length?"."+l:"")+"\n")}else{for(var E=[],O=0;O<this.items.length;O++){var N=this.items[O].execute(t);if("string"!=typeof N&&"number"!=typeof N&&!(N instanceof s.File&&0===O))throw new Error("Types mismatch");E.push(N)}if(E[0]instanceof s.File){var I=E[0];if("output"!==I.mode&&"append"!==I.mode)throw new Error("File not writable");return I.write(E.slice(1).join(" ")),void I.save(function(){e()})}a.write(E.join(" ")+(this.noLine?"":"\n"))}e()},e.exports=n},{"../../IOInterface":28,"../../filesystem":34,"../SyntaxError":42,"../statements":107}],76:[function(t,e,r){function n(){}n.prototype.execute=function(t,e){t.setPrivate("rnd_seed",Math.random()),e()},e.exports=n},{}],77:[function(t,e,r){function n(t){for(var e=new i.ArgumentStatement(t),r=0;r<e.args.length;r++){var n=e.args[r];if(!(n.child instanceof i.VariableStatement||n.child instanceof i.FunctionStatement))throw new o("Expected variable")}this.items=e.args}var i=t("../statements"),o=t("../SyntaxError");n.prototype.toString=function(){return this.items.join(", ")},n.prototype.toJSON=function(){return{items:this.items}},n.prototype.execute=function(t,e){for(var r=0;r<this.items.length;r++){if(!t["private"].data.length)throw new Error("No more data");var n=this.items[r].child,i=t["private"].data.shift();t.setVariable(n,i)}e()},e.exports=n},{"../SyntaxError":42,"../statements":107}],78:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<4)throw new o("RECT command requires 4 arguments");this.x1=e.args[0],this.y1=e.args[1],this.x2=e.args[2],this.y2=e.args[3],this.stroke=e.args.length>4?e.args[4]:!1}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../IOInterface").get("draw");n.prototype.toString=function(){var t=[this.x1,this.y1,this.x2,this.y2];return this.stroke&&t.push(this.stroke),t.join(", ")},n.prototype.toJSON=function(){return{x1:this.x1.toJSON(),y1:this.y1.toJSON(),x2:this.x2.toJSON(),y2:this.y2.toJSON(),stroke:this.stroke?this.stroke.toJSON():!1}},n.prototype.execute=function(t,e){var r=this.x1.execute(t),n=this.y1.execute(t),i=this.x2.execute(t),o=this.y2.execute(t),a=this.stroke?this.stroke.execute(t):0;t.validate(r,"number"),t.validate(n,"number"),t.validate(i,"number"),t.validate(o,"number"),t.validate(a,"number"),s.write({command:"rect",args:{x1:r,y1:n,x2:i,y2:o,stroke:a}}),e()},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],79:[function(t,e,r){function n(){}var i=t("../../IOInterface").get("draw");n.prototype.execute=function(t,e){var r=t.constants.ScreenWidth(),n=t.constants.ScreenHeight();if(n>r){var o=r;r=n,n=o}i.write({command:"setsize",args:{width:r,height:n}}),i.write({command:"locksize"}),e()},e.exports=n},{"../../IOInterface":28}],80:[function(t,e,r){function n(){}var i=t("../../IOInterface").get("draw");n.prototype.execute=function(t,e){var r=t.constants.ScreenWidth(),n=t.constants.ScreenHeight();if(r>n){var o=r;r=n,n=o}i.write({command:"setsize",args:{width:r,height:n}}),i.write({command:"locksize"}),e()},e.exports=n},{"../../IOInterface":28}],81:[function(t,e,r){function n(t){if(!t.length)throw new i("Label required");this.label=t}{var i=t("../SyntaxError"),o=t("../statements"),s=t("../../util");s.setImmediate}n.prototype.toString=function(){return this.label},n.prototype.toJSON=function(){return{label:this.label}},n.prototype.execute=function(t,e){function r(e){if(n)return void(n=!1);var i=e instanceof o.EmptyStatement&&"label"!==e.type||e instanceof o.CommandStatement&&"data"===e.name;return i?void(t.root.length<=t.cursor+1&&t.once("beforeLine",function(){t.removeListener("line",r),t.returnLabel()})):(t.removeListener("line",r),void t.returnLabel())}t["private"].data=[],t.gosubLabel(this.label);var n=!0;t.on("line",r),e()},e.exports=n},{"../../util":128,"../SyntaxError":42,"../statements":107}],82:[function(t,e,r){function n(){}n.prototype.execute=function(t,e){e()},e.exports=n},{}],83:[function(t,e,r){function n(){}n.prototype.execute=function(t,e){t.returnLabel(),e()},e.exports=n},{}],84:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<5)throw new o("RRECT command requires 5 arguments");this.x1=e.args[0],this.y1=e.args[1],this.x2=e.args[2],this.y2=e.args[3],this.radius=e.args[4],this.stroke=e.args.length>5?e.args[5]:!1}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../IOInterface").get("draw");n.prototype.toString=function(){var t=[this.x1,this.y1,this.x2,this.y2,this.radius];return this.stroke&&t.push(this.stroke),t.join(", ")},n.prototype.toJSON=function(){return{x1:this.x1.toJSON(),y1:this.y1.toJSON(),x2:this.x2.toJSON(),y2:this.y2.toJSON(),radius:this.radius.toJSON(),stroke:this.stroke?this.stroke.toJSON():!1}},n.prototype.execute=function(t,e){var r=this.x1.execute(t),n=this.y1.execute(t),i=this.x2.execute(t),o=this.y2.execute(t),a=this.radius.execute(t),u=this.stroke?this.stroke.execute(t):0;t.validate(r,"number"),t.validate(n,"number"),t.validate(i,"number"),t.validate(o,"number"),t.validate(a,"number"),t.validate(u,"number"),s.write({command:"rrect",args:{x1:r,y1:n,x2:i,y2:o,radius:a,stroke:u}}),e()},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],85:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<2)throw new o("SAVESPRITE command requires 2 arguments");this.id=e.args[0],this.fileName=e.args[1]}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../filesystem");n.prototype.toString=function(){return this.id+", "+this.fileName},n.prototype.toJSON=function(){return{id:this.id.toJSON(),fileName:this.fileName.toJSON()}},n.prototype.execute=function(t,e){var r=this.id.execute(t),n=this.fileName.execute(t);if(t.validate(r,"number"),t.validate(n,"string"),!t["private"].sprites[r])throw new Error("Invalid sprite ID");var i=t["private"].sprites[r],o=i.toDataUrl(),a=n.indexOf(":"),u="A";-1!==a&&(u=n.substring(0,a),n=n.substring(a+1)),s.drive(u,function(t){var r=t.open(n);r.clear(),r.write(o),r.save(),e()})},e.exports=n},{"../../filesystem":34,"../SyntaxError":42,"../statements":107}],86:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<3)throw new o("SHAPE command requires 3 arguments");this.pointsLength=e.args[0],this.pointsX=e.args[1],this.pointsY=e.args[2],this.stroke=e.args.length>3?e.args[3]:!1}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../IOInterface").get("draw");n.prototype.toString=function(){var t=[this.pointsLength,this.pointsX,this.pointsY];return this.stroke&&t.push(this.stroke),t.join(", ")},n.prototype.toJSON=function(){return{pointsLength:this.pointsLength.toJSON(),pointsX:this.pointsX.toJSON(),pointsY:this.pointsY.toJSON(),stroke:this.stroke?this.stroke.toJSON():!1}},n.prototype.execute=function(t,e){var r=this.pointsLength.execute(t),n=this.pointsX.execute(t),i=this.pointsY.execute(t),o=this.stroke?this.stroke.execute(t):0;if(t.validate(r,"number"),!Array.isArray(n))throw new Error("Types mismatch");if(!Array.isArray(i))throw new Error("Types mismatch");if(r>n.length||r>i.length)throw new Error("Invalid array bounds");for(var a=[],u=0;r>u;u++){var h=n[u],c=i[u];t.validate(h,"number"),t.validate(c,"number"),a.push({x:h,y:c})}s.write({command:"shape",args:{points:a,stroke:o}}),e()},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],87:[function(t,e,r){function n(t,e){if(this.duration=new i.ExpressionStatement(t,e),this.duration.error)throw this.duration.error}{var i=t("../statements");t("../SyntaxError")}n.prototype.toString=function(){return this.duration.toString()},n.prototype.toJSON=function(){return{duration:this.duration.toJSON()}},n.prototype.execute=function(t,e){var r=this.duration.execute(t);t.validate(r,"number"),setTimeout(function(){e()},1e3*r)},e.exports=n},{"../SyntaxError":42,"../statements":107}],88:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<3)throw new o("TCOLOR command requires 3 arguments");this.red=e.args[0],this.green=e.args[1],this.blue=e.args[2]}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../IOInterface").get("draw");n.prototype.toString=function(){return[this.red,this.green,this.blue].join(", ")},n.prototype.toJSON=function(){return{r:this.red.toJSON(),g:this.green.toJSON(),b:this.blue.toJSON()}},n.prototype.execute=function(t,e){var r=this.red.execute(t),n=this.green.execute(t),i=this.blue.execute(t);t.validate(r,"number"),t.validate(n,"number"),t.validate(i,"number");var o=r,a=n,u=i;r>1&&(r/=255),n>1&&(n/=255),i>1&&(i/=255),r=Math.max(0,Math.min(r,1)),n=Math.max(0,Math.min(n,1)),i=Math.max(0,Math.min(i,1)),t.setConstant("TColorR",o),t.setConstant("TColorG",a),t.setConstant("TColorB",u),s.write({command:"tcolor",args:{r:r,g:n,b:i}}),e()},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],89:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length>2)this.family=e.args[0],this.style=e.args[1],this.size=e.args[2];else if(e.args.length>1)this.familyOrStyle=e.args[0],this.size=e.args[1];else if(e.args.length>0){var r=e.args[0];"string"===r.child.type||r.child instanceof i.StringStatement?this.familyOrStyle=r:this.size=r}else this.reset=!0}var i=t("../statements"),o=(t("../SyntaxError"),t("../../IOInterface").get("draw")),s=["light","bold","italic"],a=["American Typewriter","AppleGothic","Arial","Arial Rounded","Courier","Courier New","Georgia","Helvetica","Marker Felt","Times","Trebuchet","Verdana","Zapfino"];n.prototype.toString=function(){var t=[];return this.family?t.push(this.family,this.style):this.familyOrStyle&&t.push(this.familyOrStyle),this.size&&t.push(this.size),t.join(", ")},n.prototype.toJSON=function(){return{reset:this.reset,family:this.family?this.family.toJSON():!1,style:this.style?this.style.toJSON():!1,size:this.size?this.size.toJSON():!1,familyOrStyle:this.familyOrStyle?this.familyOrStyle.toJSON():!1}},n.prototype.execute=function(t,e){var r=!1,n=!1,i=!1;if(this.reset)r="Zapfino",n="",i=14;else if(this.family)r=this.family.execute(t),n=this.style.execute(t).toLowerCase();else if(this.familyOrStyle){for(var u=this.familyOrStyle.execute(t),h=u.toLowerCase(),c=h.split(" "),f=!0,p=0;p<c.length;p++)if(-1===s.indexOf(c[p])){f=!1;break}f?n=h:r=u}if(this.size&&(i=this.size.execute(t)),r!==!1&&(t.validate(r,"string"),-1===a.indexOf(r)))throw new Error("Invalid font name");if(n!==!1){t.validate(n,"string"),n=n.trim();for(var l=n.split(" "),d=0;d<l.length;d++){var m=l[d].trim();if(m.length&&-1===s.indexOf(m))throw new Error("Invalid font style")}}i!==!1&&t.validate(i,"number"),o.write({command:"font",args:{family:r,style:n,height:i}}),e()},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],90:[function(t,e,r){function n(t){var e=new i.ArgumentStatement(t);if(e.args.length<6)throw new o("TRIANGLE command requires 6 arguments");this.x1=e.args[0],this.y1=e.args[1],this.x2=e.args[2],this.y2=e.args[3],this.x3=e.args[4],this.y3=e.args[5],this.stroke=e.args.length>6?e.args[6]:!1}var i=t("../statements"),o=t("../SyntaxError"),s=t("../../IOInterface").get("draw");n.prototype.toString=function(){var t=[this.x1,this.y1,this.x2,this.y2,this.x3,this.y3];return this.stroke&&t.push(this.stroke),t.join(", ")},n.prototype.toJSON=function(){return{x1:this.x1.toJSON(),y1:this.y1.toJSON(),x2:this.x2.toJSON(),y2:this.y2.toJSON(),x3:this.x3.toJSON(),y3:this.y3.toJSON(),stroke:this.stroke?this.stroke.toJSON():!1}},n.prototype.execute=function(t,e){var r=this.x1.execute(t),n=this.y1.execute(t),i=this.x2.execute(t),o=this.y2.execute(t),a=this.x3.execute(t),u=this.y3.execute(t),h=this.stroke?this.stroke.execute(t):0;t.validate(r,"number"),t.validate(n,"number"),t.validate(i,"number"),t.validate(o,"number"),t.validate(a,"number"),t.validate(u,"number"),t.validate(h,"number"),s.write({command:"triangle",args:{x1:r,y1:n,x2:i,y2:o,x3:a,y3:u,stroke:h}}),e()},e.exports=n},{"../../IOInterface":28,"../SyntaxError":42,"../statements":107}],91:[function(t,e,r){function n(){}n.prototype.execute=function(t,e){e()},e.exports=n},{}],92:[function(t,e,r){function n(t,e){this.block=e}n.prototype.toJSON=function(){return{block:this.block.toJSON()}},n.prototype.execute=function(t,e){var r=this.block.references();if(!r.length)throw new Error("WEND without WHILE");t.cursor=r[0].start,e()},e.exports=n},{}],93:[function(t,e,r){function n(t,e){var r=new i.ArgumentStatement(t,{separator:!1});this.condition=r.args[0],this.block=e({start:"WHILE",end:"WEND"})}var i=t("../statements"),o=t("../../util"),s=o.setImmediate;n.prototype.toString=function(){return this.condition.toString()},n.prototype.toJSON=function(){return{condition:this.condition.toJSON(),block:this.block.toJSON()}},n.prototype.execute=function(t,e){var r=this.condition.execute(t);r?s(e):(t.cursor=this.block.end+1,e())},e.exports=n},{"../../util":128,"../statements":107}],94:[function(t,e,r){r.dim=t("./DimCommand"),r.end=t("./EndCommand"),r.gosub=t("./GosubCommand"),r["goto"]=t("./GotoCommand"),r.input=t("./InputCommand"),r.print=t("./PrintCommand"),r.randomize=t("./RandomizeCommand"),r["return"]=t("./ReturnCommand"),r.pause=t("./PauseCommand"),r.sleep=t("./SleepCommand"),r.cls=t("./ClsCommand"),r.play=t("./PlayCommand"),r.volume=t("./VolumeCommand"),r.playspeed=t("./PlayspeedCommand"),r.restore=t("./RestoreCommand"),r.data=t("./DataCommand"),r.read=t("./ReadCommand"),r.color=t("./ColorCommand"),r.tcolor=t("./TcolorCommand"),r.bcolor=t("./BcolorCommand"),r.begindraw=t("./BegindrawCommand"),r.enddraw=t("./EnddrawCommand"),r.point=t("./PointCommand"),r.line=t("./LineCommand"),r.rect=t("./RectCommand"),r.rrect=t("./RrectCommand"),r.circle=t("./CircleCommand"),r.ellipse=t("./EllipseCommand"),r.shape=t("./ShapeCommand"),r.triangle=t("./TriangleCommand"),r.piechart=t("./PiechartCommand"),r.drawtext=t("./DrawtextCommand"),r.textfont=t("./TextfontCommand"),r.loadsprite=t("./LoadspriteCommand"),r.drawsprite=t("./DrawspriteCommand"),r.savesprite=t("./SavespriteCommand"),r.retina=t("./RetinaCommand"),r.antialias=t("./AntialiasCommand"),r.lockorientation=t("./LockorientationCommand"),r.requireportrait=t("./RequireportraitCommand"),r.requirelandscape=t("./RequirelandscapeCommand"),r.accelcalibrate=t("./AccelcalibrateCommand"),r.open=t("./OpenCommand"),r.close=t("./CloseCommand"),r["while"]=t("./WhileCommand"),r.wend=t("./WendCommand"),r["if"]=t("./IfCommand"),r["else"]=t("./ElseCommand"),r.endif=t("./EndifCommand"),r["for"]=t("./ForCommand"),r.next=t("./NextCommand")},{"./AccelcalibrateCommand":43,"./AntialiasCommand":44,"./BcolorCommand":45,"./BegindrawCommand":46,"./CircleCommand":47,"./CloseCommand":48,"./ClsCommand":49,"./ColorCommand":50,"./DataCommand":51,"./DimCommand":52,"./DrawspriteCommand":53,"./DrawtextCommand":54,"./EllipseCommand":55,"./ElseCommand":56,"./EndCommand":57,"./EnddrawCommand":58,"./EndifCommand":59,"./ForCommand":60,"./GosubCommand":61,"./GotoCommand":62,"./IfCommand":63,"./InputCommand":64,"./LineCommand":65,"./LoadspriteCommand":66,"./LockorientationCommand":67,"./NextCommand":68,"./OpenCommand":69,"./PauseCommand":70,"./PiechartCommand":71,"./PlayCommand":72,"./PlayspeedCommand":73,"./PointCommand":74,"./PrintCommand":75,"./RandomizeCommand":76,"./ReadCommand":77,"./RectCommand":78,"./RequirelandscapeCommand":79,"./RequireportraitCommand":80,"./RestoreCommand":81,"./RetinaCommand":82,"./ReturnCommand":83,"./RrectCommand":84,"./SavespriteCommand":85,"./ShapeCommand":86,"./SleepCommand":87,"./TcolorCommand":88,"./TextfontCommand":89,"./TriangleCommand":90,"./VolumeCommand":91,"./WendCommand":92,"./WhileCommand":93}],95:[function(t,e,r){function n(t,e){return new a(t.message+" on line "+(e+1))}function i(t){try{for(var e={},r=[],i=new u,h=t.split("\n"),c=0;c<h.length;c++)try{var f=o(h[c].trim(),c,e,!1,i);if(f instanceof a)throw n(f,c);if(f.error instanceof a)throw n(f.error,c);r[c]=f}catch(p){throw n(p,c)}return new s(r,e,i)}catch(p){return{error:p}}}function o(t,e,r,n,i){function s(t){return h.findPositions(t,[{start:"(",end:")"},{start:'"',end:'"'}])}if(t=t.trim(),""===t)return new g("empty");if(0===t.indexOf("'")||"REM"===t.toUpperCase()||0===t.toUpperCase().indexOf("REM "))return new p(t.substring(t.indexOf(" ")).trim());var u;u=s(t);var c=h.indexOfOutside(t,"'",0,u);if(-1!==c&&(t=t.substring(0,c).trim(),u=s(t)),":"===t[t.length-1]){var x=t.substring(0,t.length-1).toLowerCase();return r[x]=e,new g("label")}0===t.indexOf("END IF")&&(t="ENDIF");var v=h.indexOfOutside(t," ",0,u);if(-1===v){{parseInt(t)}if(!n&&!isNaN(parseInt(t)))return r[t]=e,new g("label")}var w,b;if(-1!==v){if(w=t.substring(0,v).trim(),b=t.substring(v).trim(),!n&&!isNaN(parseInt(w)))return r[w]=e,o(b,e,r,!0,i);if("="===b[0])return new f(new d(w),new m(b.substring(1).trim()));var S=w.indexOf("=");if(-1!==S){var E=w+" "+b,O=E.substring(0,S).trim(),N=E.substring(S+1).trim();return new f(new d(O),new m(N))}}else{w=t,b="";var I=w.indexOf("=");if(-1!==I){var C=w.substring(0,I),_=w.substring(I+1);return new f(new d(C),new m(_))}var L=w.indexOf("(");if(-1!==L){var A=w.indexOf(")");if(-1===A)return new a("Unexpected open bracket");var k=w.substring(0,L);if(!isNaN(parseInt(k)))return new a("Expected function name");var J=w.substring(L+1,A);return new y(k,J)}}return w=w.toUpperCase(),new l(w.toLowerCase(),b,i,e)}var s=t("./AbstractSyntaxTree"),a=t("./SyntaxError"),u=t("./Block"),h=t("../util"),c=t("./statements"),f=c.AssignmentStatement,p=c.CommentStatement,l=c.CommandStatement,d=c.VariableStatement,m=c.ExpressionStatement,g=c.EmptyStatement,y=c.FunctionStatement;r.Block=u,r.commands=t("./commands"),r.statements=c,r.AbstractSyntaxTree=t("./AbstractSyntaxTree"),r.SyntaxError=t("./SyntaxError"),r.parse=i,r.parseLine=o},{"../util":128,"./AbstractSyntaxTree":39,"./Block":41,"./SyntaxError":42,"./commands":94,"./statements":107}],96:[function(t,e,r){function n(t,e,r){if(e=e||{},this.value=t,this.flags={},this.args=[],this.options=e,"undefined"==typeof e.parse&&(e.parse=!0),"undefined"==typeof e.separator&&(e.separator=","),"undefined"==typeof e.parseArgs&&(e.parseArgs=!0),e.parse){if(e.flags)for(var n=!0;n;){var s=t.indexOf(" ");-1===s&&(s=t.length);var a=t.substring(0,s).trim().toUpperCase();-1!==e.flags.indexOf(a)?(this.flags[a]=!0,t=t.substring(s).trim()):n=!1}this.rawArgs=t,t=t.trim();var u=[t];if(e.separator)if(t.length){var h=o.findPositions(t,[{start:'"',end:'"'},{start:"(",end:")"}]);u=o.splitOutside(t,e.separator,h)}else u=[];for(var c=0;c<u.length;c++){var f=u[c].trim();e.parseArgs&&(f=new i.ExpressionStatement(f,r)),this.args.push(f)}}}var i=t("./"),o=t("../../util");n.prototype.toJSON=function(){return{type:"ArgumentStatement",value:this.value,flags:this.flags,args:this.args,options:this.options}},e.exports=n},{"../../util":128,"./":107}],97:[function(t,e,r){function n(t,e){this.variable=t,this.expression=e}n.prototype.toString=function(){return this.variable.toString()+" = "+this.expression.toString()},n.prototype.toJSON=function(){return{type:"AssignmentStatement",variable:this.variable.toJSON(),expression:this.expression.toJSON()}},n.prototype.execute=function(t){t.setVariable(this.variable,this.expression)},e.exports=n},{}],98:[function(t,e,r){function n(t,e,r,n){if(this.name=t,this.args=e,!i[t])throw new o("Unknown command: "+t);this.command=new i[t](e,r.create(n))}var i=t("../commands"),o=t("../SyntaxError");n.prototype.toString=function(){var t=this.command.toString();return this.name.toUpperCase()+("[object Object]"===t?"":" "+t)},n.prototype.toJSON=function(){return{type:"CommandStatement",name:this.name,command:this.command.toJSON?this.command.toJSON():{}}},n.prototype.execute=function(t){return t.callCommand(this.command)},e.exports=n},{"../SyntaxError":42,"../commands":94}],99:[function(t,e,r){function n(t){this.text=t}n.prototype.toString=function(){return"' "+this.text},n.prototype.toJSON=function(){return{type:"CommentStatement",text:this.text}},n.prototype.execute=function(){},e.exports=n},{}],100:[function(t,e,r){function n(t){this.type=t}n.prototype.toString=function(){return""},n.prototype.toJSON=function(){return{type:"EmptyStatement",lineType:this.type}},n.prototype.execute=function(){},e.exports=n},{}],101:[function(t,e,r){function n(t,e){if(this.child=i(t,e?e.line:"unknown"),this.child instanceof a)throw this.child;if(this.child.error)throw this.child.error}function i(t,e){t=t.trim();for(var r=t.toLowerCase(),n=h.findPositions(r,[{start:'"',end:'"'},{start:"(",end:")"}]),f=0;f<u.length;f++){var p=u[f],l=Object.keys(p),d=h.findLastOutside(r,l,r.length,n);if(-1!==d.index){var m=t.substring(0,d.index).trim();if("-"===d.found||"+"===d.found){var g=h.findLast(m,c);if(-1!==g.index){var y=m.substring(g.index+g.found.length).trim();if(!y.length)continue}}var x=i(m),v=i(t.substring(d.index+d.found.length)),w=p[d.found];if(!w)throw new a("Unknown operator");return new w(x,v)}}var b=t.indexOf("(");if(-1!==b){var S=t.lastIndexOf(")");if(-1===S)throw new a("Expected end bracket in "+t);var E=t.substring(b+1,S).trim(),O=t.substring(0,b).trim();if(O.length)return new s.FunctionStatement(O,E);var N=t.substring(S+1).trim();if(N.length)throw new a("Unexpected expression");return i(E)}return o(t)}function o(t){if("#"===t[0]){var e=t.substring(1);return isNaN(parseInt(e))?new a("Unexpected hash"):new s.PointerStatement(e)}var r=-1!==t.indexOf('"');if(r){if('"'!==t[0]||'"'!==t[t.length-1])return new a("Unexpected quote");var n=t.slice(1,t.length-1);return new s.StringStatement(n)}var i=parseFloat(t);return isNaN(i)?new s.VariableStatement(t):new s.NumberStatement(i)}for(var s=t("./"),a=t("../SyntaxError"),u=t("./operators"),h=t("../../util"),c=[],f=0;f<u.length;f++)c=c.concat(Object.keys(u[f]));n.prototype.toString=function(){return this.child.toString()},n.prototype.toJSON=function(){return{type:"ExpressionStatement",child:this.child.toJSON()}},n.prototype.execute=function(t){if(this.error)throw this.error;return this.child.execute(t)},e.exports=n},{"../../util":128,"../SyntaxError":42,"./":107,"./operators":126}],102:[function(t,e,r){function n(t,e){"$"===t[t.length-1]?(this.type="string",this.name=t.substring(0,t.length-1)):(this.type="number",this.name=t);var r=o.findPositions(e,[{start:'"',end:'"'},{start:"(",end:")"}]),n=o.splitOutside(e,",",r);this.args=[];for(var s=0;s<n.length;s++)this.args.push(new i.ExpressionStatement(n[s].trim()))}var i=t("./"),o=t("../../util");n.prototype.toString=function(){for(var t=[],e=0;e<this.args.length;e++)t.push(this.args[e].toString());return this.name+("string"===this.type?"$":"")+"("+t.join(", ")+")"},n.prototype.toJSON=function(){return{type:"FunctionStatement",name:this.name,varType:this.type,args:this.args}},n.prototype.execute=function(t){for(var e=[],r=0;r<this.args.length;r++){var n=this.args[r];if(n.error)throw n.error;e.push(n.execute(t))}return t.callFunction(this,e)},e.exports=n},{"../../util":128,"./":107}],103:[function(t,e,r){function n(t){this.value=t}n.prototype.toString=function(){return this.value.toString()},n.prototype.toJSON=function(){return{type:"NumberStatement",value:this.value}},n.prototype.execute=function(){return this.value},e.exports=n},{}],104:[function(t,e,r){function n(t){this.id=t}n.prototype.toString=function(){return"#"+this.id},n.prototype.toJSON=function(){return{type:"PointerStatement",id:this.id}},n.prototype.execute=function(t){return t.getPointer(this)},e.exports=n},{}],105:[function(t,e,r){function n(t){this.value=t}n.prototype.toString=function(){return'"'+this.value+'"'},n.prototype.toJSON=function(){return{type:"StringStatement",value:this.value}},n.prototype.execute=function(){return this.value},e.exports=n},{}],106:[function(t,e,r){function n(t){var e=t.indexOf("(");if(-1!==e){var r=t.indexOf(")");if(-1===r)throw new i("Expected end bracket");var n=t.substring(0,e),s=t.substring(e+1,r).trim(),a=new o.ArgumentStatement(s);t=n,this.isArray=!0,this.dimensions=a.args}else this.isArray=!1;"$"===t[t.length-1]?(this.type="string",this.name=t.substring(0,t.length-1)):(this.type="number",this.name=t)}var i=t("../SyntaxError"),o=t("./");n.prototype.toString=function(){var t=this.name+("string"===this.type?"$":"");return this.isArray&&(t+="("+this.dimensions.join(", ")+")"),t},n.prototype.toJSON=function(){return{type:"VariableStatement",name:this.name,varType:this.type,dimensions:this.dimensions}},n.prototype.execute=function(t){return t.getVariable(this)},e.exports=n},{"../SyntaxError":42,"./":107}],107:[function(t,e,r){r.operators=t("./operators"),r.ArgumentStatement=t("./ArgumentStatement"),r.AssignmentStatement=t("./AssignmentStatement"),r.CommandStatement=t("./CommandStatement"),r.CommentStatement=t("./CommentStatement"),r.EmptyStatement=t("./EmptyStatement"),r.ExpressionStatement=t("./ExpressionStatement"),r.FunctionStatement=t("./FunctionStatement"),r.NumberStatement=t("./NumberStatement"),r.PointerStatement=t("./PointerStatement"),r.StringStatement=t("./StringStatement"),r.VariableStatement=t("./VariableStatement")},{"./ArgumentStatement":96,"./AssignmentStatement":97,"./CommandStatement":98,"./CommentStatement":99,"./EmptyStatement":100,"./ExpressionStatement":101,"./FunctionStatement":102,"./NumberStatement":103,"./PointerStatement":104,"./StringStatement":105,"./VariableStatement":106,"./operators":126}],108:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" + "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:"+",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){var e=this.lexpr.execute(t),r=this.rexpr.execute(t);return e?e+r:r},e.exports=n},{}],109:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" AND "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:" and ",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){return this.lexpr.execute(t)&&this.rexpr.execute(t)?1:0},e.exports=n},{}],110:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" BAND "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:" band ",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){var e=this.lexpr.execute(t),r=this.rexpr.execute(t);return t.validate(e,"number"),t.validate(r,"number"),e&r},e.exports=n},{}],111:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" / "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:"/",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){var e=this.lexpr.execute(t),r=this.rexpr.execute(t);if("number"!=typeof e||"number"!=typeof r)throw new Error("Types mismatch");return e/r},e.exports=n},{}],112:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" = "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:"=",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){return this.lexpr.execute(t)==this.rexpr.execute(t)?1:0},e.exports=n},{}],113:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" > "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:">",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){return this.lexpr.execute(t)>this.rexpr.execute(t)?1:0},e.exports=n},{}],114:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" >= "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:">=",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){return this.lexpr.execute(t)>=this.rexpr.execute(t)?1:0},e.exports=n},{}],115:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" < "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:"<",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){return this.lexpr.execute(t)<this.rexpr.execute(t)?1:0},e.exports=n},{}],116:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" <= "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:"<=",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){return this.lexpr.execute(t)<=this.rexpr.execute(t)?1:0},e.exports=n},{}],117:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" * "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:"*",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){var e=this.lexpr.execute(t),r=this.rexpr.execute(t);if("number"!=typeof e||"number"!=typeof r)throw new Error("Types mismatch");return e*r},e.exports=n},{}],118:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return"NOT "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:"not ",rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){return this.rexpr.execute(t)?0:1},e.exports=n},{}],119:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" <> "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:"<>",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){return console.log("not equal comparator"),this.lexpr.execute(t)!=this.rexpr.execute(t)?1:0},e.exports=n},{}],120:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return"BNOT "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:"bnot ",rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){var e=this.rexpr.execute(t);return t.validate(e,"number"),~e},e.exports=n},{}],121:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" OR "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:" or ",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){return this.lexpr.execute(t)||this.rexpr.execute(t)?1:0},e.exports=n},{}],122:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" BOR "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:" bor ",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},
n.prototype.execute=function(t){var e=this.lexpr.execute(t),r=this.rexpr.execute(t);return t.validate(e,"number"),t.validate(r,"number"),e|r},e.exports=n},{}],123:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" ^ "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:"^",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){var e=this.lexpr.execute(t),r=this.rexpr.execute(t);if("number"!=typeof e||"number"!=typeof r)throw new Error("Types mismatch");return Math.pow(e,r)},e.exports=n},{}],124:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" - "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:"-",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){var e=this.lexpr.execute(t),r=this.rexpr.execute(t);if(!e&&"number"==typeof r)return-1*r;if("number"!=typeof e||"number"!=typeof r)throw new Error("Types mismatch");return e-r},e.exports=n},{}],125:[function(t,e,r){function n(t,e){this.lexpr=t,this.rexpr=e}n.prototype.toString=function(){return this.lexpr.toString()+" BXOR "+this.rexpr.toString()},n.prototype.toJSON=function(){return{type:" bxor ",lexpr:this.lexpr.toJSON(),rexpr:this.rexpr.toJSON()}},n.prototype.execute=function(t){var e=this.lexpr.execute(t),r=this.rexpr.execute(t);return t.validate(e,"number"),t.validate(r,"number"),e^r},e.exports=n},{}],126:[function(t,e,r){e.exports=[{" and ":t("./AndComparator")," or ":t("./OrComparator")},{"not ":t("./NotComparator"),"=":t("./EqualComparator"),"<>":t("./NotEqualComparator"),">":t("./GtComparator"),">=":t("./GteComparator"),"<":t("./LtComparator"),"<=":t("./LteComparator")},{"+":t("./AdditionOperator"),"-":t("./SubtractionOperator")," band ":t("./AndOperator")," bor ":t("./OrOperator")," bxor ":t("./XorOperator")," xor ":t("./XorOperator"),"bnot ":t("./NotOperator")},{"/":t("./DivisionOperator"),"*":t("./MultiplicationOperator")},{"^":t("./PowerOperator")}]},{"./AdditionOperator":108,"./AndComparator":109,"./AndOperator":110,"./DivisionOperator":111,"./EqualComparator":112,"./GtComparator":113,"./GteComparator":114,"./LtComparator":115,"./LteComparator":116,"./MultiplicationOperator":117,"./NotComparator":118,"./NotEqualComparator":119,"./NotOperator":120,"./OrComparator":121,"./OrOperator":122,"./PowerOperator":123,"./SubtractionOperator":124,"./XorOperator":125}],127:[function(t,e,r){function n(t){t=t||{};var e=t.prompt||"> ",r=t.eval||i,n=new h,s=new f,a=new c([],{},s);o(n,a,e,e,-1,r)}function i(t,e,r,n,i){try{if("."===t[0]){var o=t.substring(1),s=o.indexOf(" "),h="";switch(-1!==s&&(h=o.substring(s+1).trim(),o=o.substring(0,s).trim()),o){case"break":r.root.splice(e._blockStart),e._blockStart=!1,i();break;case"clear":e._blockStart=!1,e.root=r.root=[],e.labels=r.labels={},e.options.cursorStart=0,e.gosubs=[],e.stringVars={},e.numberVars={},e.pointers={},i();break;case"exit":break;case"help":a.write(".break       - Clear the current multi-line expression\n"),a.write(".clear       - Reset the current context and clear the current multi-line expression\n"),a.write(".exit        - Close the I/O stream, causing the REPL to exit\n"),a.write(".help        - Show this list of special commands\n"),a.write(".load <file> - Load a file into the session\n"),a.write(".save <file> - Save the current session\n"),i();break;case"load":u.readFile(h,{encoding:"utf8"},function(t,n){try{if(t)throw t;for(var o=n.split("\n"),s=0;s<o.length;s++){var u=o[s],h=p.parseLine(u,r.root.length,r.labels,!1,r.manager);if(h instanceof d)throw h;if(h.error)throw h.error;r.root.push(h)}r.manager.parse(r),r.execute(e,i)}catch(t){a.write(t+"\n"),i()}});break;case"save":var c=r.toString();u.writeFile(h,c,function(t){t&&a.write(t+"\n"),i()});break;default:throw new Error("Unknown REPL command")}return}var f=p.parseLine(t,r.root.length,r.labels,!1,r.manager);if(f instanceof d)throw f;if(f.error)throw f.error;r.root.push(f),r.manager.parse(r),"number"==typeof e._blockStart?(e.options.cursorStart=e._blockStart,e._blockStart=!1):e.options.cursorStart=n,r.execute(e,i)}catch(m){var g=m.message;m instanceof d&&-1!==g.indexOf("without")?("number"!=typeof e._blockStart&&(e._blockStart=r.root.length-1),i("... ")):(a.write(m+"\n"),r.root.pop(),r.root.push(new l.EmptyStatement),i())}}function o(t,e,r,n,i,s){a.question(r,function(r){s(r,t,e,-1===i?e.root.length:i,function(r,i){o(t,e,r||n,n,"undefined"==typeof i?-1:i,s)})})}for(var s=t("./IOInterface"),a=s.getDefault(),u=t("fs"),h=t("./executor/ExecutionContext"),c=t("./parser/AbstractSyntaxTree"),f=t("./parser/Block/index"),p=t("./parser/index"),l=t("./parser/statements/index"),d=t("./parser/SyntaxError"),m=t("./parser/commands/index"),g=Object.keys(m),y=[],x=0;x<g.length;x++)y.push(g[x].toUpperCase());r.start=n},{"./IOInterface":28,"./executor/ExecutionContext":29,"./parser/AbstractSyntaxTree":39,"./parser/Block/index":41,"./parser/SyntaxError":42,"./parser/commands/index":94,"./parser/index":95,"./parser/statements/index":107,fs:1}],128:[function(t,e,r){(function(t){function e(t,e,r){for(var n=t.length+1,i="",o=0;o<e.length;o++){var s=e[o],a=t.indexOf(s,r);-1!==a&&n>a&&(n=a,i=s)}return n===t.length+1?{index:-1,found:""}:{index:n,found:i}}function n(t,e,r){for(var n=-1,i="",o=0;o<e.length;o++){var s=e[o],a=t.lastIndexOf(s,r);a>n&&(n=a,i=s)}return{index:n,found:i}}function i(t,r,n,i){var o,s={start:0,end:n?n-1:-1};do o=e(t,r,s.end+1);while(-1!==o.index&&(s=c(o.index,i)));return o}function o(t,e,r,i){var o,s={start:r?r+1:t.length+1,end:0};do o=n(t,e,s.start-1);while(-1!==o.index&&(s=c(o.index,i)));return o}function s(t,e,r,n){var i,o={start:0,end:r?r-1:-1};do i=t.indexOf(e,o.end+1);while(-1!==i&&(o=c(i,n)));return i}function a(t,e,r,n){var i,o={start:r?r+1:t.length+1,end:0};do i=t.lastIndexOf(e,o.start-1);while(-1!==i.index&&(o=c(i.index,n)));return i}function u(t,e,r){for(var n=[],i="",o=0;o<t.length;o++){i+=t[o];var s=c(o,r);!s&&f(i,e)&&(n.push(i.substring(0,i.length-e.length)),i="")}return n.push(i),n}function h(t,e){for(var r=0,n=-1,i=[],o={},s="",a=0;a<t.length;a++){s+=t[a];for(var u=0;u<e.length;u++){var h=e[u];r>0&&f(s,h.end)?(r--,0===r&&n===u&&(o.end=a-h.end.length+1,n=-1,s="",i.push(o),o={})):f(s,h.start)&&(r++,1===r&&-1===n&&(o={startChar:h.start,endChar:h.end,start:a},n=u,s=""))}}return i}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];if(t>=n.start&&t<=n.end)return n}return!1}function f(t,e){return t.length<e.length?!1:t===e?!0:t.lastIndexOf(e)===t.length-e.length}function p(t,e,r){for(t=String(t),r=r||" ";t.length<e;)t+=r;return t}function l(t,e){arguments.length<2&&(e=t,t={});for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function d(){}r.findNext=e,r.findLast=n,r.findNextOutside=i,r.findLastOutside=o,r.indexOfOutside=s,r.lastIndexOfOutside=a,r.splitOutside=u,r.findPositions=h,r.inPosition=c,r.endsWith=f,r.pad=p,r.shallowClone=l,r.setImmediate=function(){return"undefined"!=typeof setImmediate?setImmediate:function(t){setTimeout(t,0)}}(),r.now=function(){return t.hrtime?function(){var e=t.hrtime();return e[0]+e[1]/1e9}:function(){var t=window.performance.now();return t/1e3}}(),d.prototype.valueOf=function(){return this.value},r.DeferredValue=d}).call(this,t("_process"))},{_process:11}]},{},[27]);